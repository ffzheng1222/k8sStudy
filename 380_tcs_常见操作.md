# 380  tcs常见操作



#### 常见通用组件



```sh

[root@tcs-10-200-1-133 ~]#  kubectl  get pod -ntcs-system | grep  midd

middleware-controller-677bd44d65-v7f56                1/1     Running   1          13d





[root@tcs-10-200-1-133 ~]#  kubectl  get pod -ntcs-system | grep sd-controller-manager

sd-controller-manager-5656c9c685-mh2fq                1/1     Running   3          43d





[root@tcs-10-200-1-133 ~]#  kubectl  get pod -ntcs-system | grep tce-cloud-provider 

tce-cloud-provider-6d9d9ff977-7dkw7                   1/1     Running   0          9d

tce-cloud-provider-6d9d9ff977-rfwq4                   1/1     Running   0          9d





[root@tcs-10-200-1-133 ~]#  kubectl  get pod -nssm  | grep ssm

ssm-platform-api-56c9976fc8-5phzx           1/1     Running   0          45d

ssm-platform-api-56c9976fc8-j27f9           1/1     Running   0          45d

ssm-platform-controllers-548c8c465b-m2vwq   1/1     Running   2          45d

ssm-platform-controllers-548c8c465b-wdrfh   1/1     Running   1          45d





[root@tcs-10-200-1-133 ~]#  kubectl  get stateset  -nsso 

NAME                                  DESIRED   READY   AGE

cfgsvr-tcemongodbbase                 3         3       44d

kafka-tce-kafka-kafka-1               3         3       44d

kafka-tce-kafka-kafka-1-group-cls     0                 36d

kafka-tce-kafka-kafka-1-group-other   3         3       44d

rabbitmq-tce-cmq-cmq-1                3         3       45d

rabbitmq-tce-mq-mq-1                  3         3       44d

shard-tcemongodbbase-trq0it0t         3         3       44d





[root@tcs-10-200-1-133 ~]#  kubectl  get deploy -nssm 

NAME                       READY   UP-TO-DATE   AVAILABLE   AGE

ces-operator               2/2     2            2           35d

ces-vendor                 2/2     2            2           35d

cmq-vendor                 2/2     2            2           45d

component-apiserver        1/1     1            1           45d

credis-operator            1/1     1            1           45d

credis-vendor              2/2     2            2           45d

csp-exporter               2/2     2            2           45d

csp-vendor                 2/2     2            2           45d

etcd-operator              2/2     2            2           45d

etcd-vendor                2/2     2            2           45d

hdfs-operator              2/2     2            2           45d

hdfs-vendor                2/2     2            2           45d

kafka-operator             2/2     2            2           45d

kafka-vendor               2/2     2            2           45d

mongo-operator             1/1     1            1           45d

mongo-vendor               2/2     2            2           45d

rabbitmq-operator          2/2     2            2           45d

rabbitmq-vendor            2/2     2            2           45d

ssm-platform-api           2/2     2            2           45d

ssm-platform-controllers   2/2     2            2           45d

stateset-controller        1/1     1            1           45d

tdsql-operator             2/2     2            2           45d

tdsql-vendor               2/2     2            2           45d

zookeeper-operator         2/2     2            2           44d

zookeeper-vendor           2/2     2            2           44d





[root@tcs-10-200-1-133 ~]#  kubectl  get   crd  | grep -wE "zookeepers|rabbitmqs|ces|tdsqls|credis|kafkas|mongoes"

ces.infra.tce.io                              2020-12-22T06:31:05Z

credis.infra.tce.io                           2020-12-22T06:33:05Z

kafkas.infra.tce.io                           2020-10-02T09:01:05Z

mongoes.infra.tce.io                          2020-10-02T09:01:17Z

rabbitmqs.infra.tce.io                        2020-10-02T09:00:28Z

tdsqls.infra.tce.io                           2020-12-22T06:29:59Z

zookeepers.infra.tce.io                       2020-10-02T09:00:48Z



```







#### 物理机支撑zookeeper



```sh

[root@tcs-10-200-1-133 ~]#  kubectl  get  app -ntce | grep product-tcenter-support-zk

product-tcenter-support-zk                               Succeeded   3       3  





[root@tcs-10-200-1-133 ~]#  kubectl  get  comp -ntce | grep  zk.zk346

zk.zk346                                                 MiddlewareWorkload

zk.zk346-group-other                                     MiddlewareWorkload

zk.zk346-group-vpc                                       MiddlewareWorkload





[root@tcs-10-200-1-133 ~]#  kubectl  get MiddlewareWorkload -ntce | grep  zk.zk346

zk.zk346                                          zookeeper   Ready      42d

zk.zk346-group-other                              zookeeper   Ready      42d

zk.zk346-group-vpc                                zookeeper   Ready      42d



[root@tcs-10-200-1-133 ~]#  kubectl  get mw -ntce | grep  zk.zk346

zk.zk346                                          zookeeper   Ready      42d

zk.zk346-group-other                              zookeeper   Ready      42d

zk.zk346-group-vpc                                zookeeper   Ready      42d





================================================================================================

[root@tcs-10-200-1-133 ~]#  kubectl  get   crd  | grep -wE "zookeepers"

zookeepers.infra.tce.io                       2020-10-02T09:00:48Z



[root@tcs-10-200-1-133 ~]#  kubectl  get zookeepers.infra.tce.io  -A 

No resources found



[root@tcs-10-200-1-133 ~]#  kubectl  get zookeeper -A 

No resources found



[root@tcs-10-200-1-133 ~]#  kubectl  get serviceplan  | grep zookeeper

zk.zk346                     zookeeper   43d

zk.zk346-group-other         zookeeper   43d

zk.zk346-group-vpc           zookeeper   43d

zookeeper-advanced           zookeeper   44d

zookeeper-standard           zookeeper   44d





================================================================================================

[root@tcs-10-200-1-133 ~]#  kubectl  get  pod -nssm | grep  -E "zk|zookeeper"

zookeeper-operator-6c5bc8c8dc-2zxlh         1/1     Running   5          43d

zookeeper-operator-6c5bc8c8dc-pjszx         1/1     Running   7          43d

zookeeper-vendor-cdc8d7759-524mx            1/1     Running   0          43d

zookeeper-vendor-cdc8d7759-bxxzx            1/1     Running   0          43d

[root@tcs-10-200-1-133 ~]# 

[root@tcs-10-200-1-133 ~]#

[root@tcs-10-200-1-133 ~]#  kubectl  get  pod -nsso | grep  -E "zk|zookeeper"

exporter-tce-zk-zk346-cd464dc5f-ph6g7                            1/1     Running   0          42d

exporter-tce-zk-zk346-group-other-6f75796769-shl55               1/1     Running   0          42d

exporter-tce-zk-zk346-group-vpc-794b7b8b4b-9z66x                 1/1     Running   0          42d





================================================================================================

[root@tcs-10-200-1-133 ~]#  kubectl  get  secret  -nssm | grep  -E "zk|zookeeper"

b-zookeeper-42hcv-tce-zk-api3                   Opaque

b-zookeeper-42hcv-tce-zk-barad                  Opaque

b-zookeeper-42hcv-tce-zk-cbs                    Opaque

b-zookeeper-42hcv-tce-zk-ops-cmdb               Opaque

b-zookeeper-42hcv-tce-zk-osppro-ntp             Opaque

b-zookeeper-42hcv-tce-zk-osppro-yum             Opaque

b-zookeeper-42hcv-tce-zk-psg-50010001           Opaque

b-zookeeper-42hcv-tce-zk-redis                  Opaque

b-zookeeper-42hcv-tce-zk-tcenter-collector      Opaque

b-zookeeper-42hcv-tce-zk-tdmq                   Opaque

b-zookeeper-42hcv-tce-zk-yunjing                Opaque

b-zookeeper-42hcv-tce-zk.zk346-host             Opaque

b-zookeeper-4w5xo-tce-zk-vpc                    Opaque

b-zookeeper-4w5xo-tce-zk-vpc-dfw                Opaque

b-zookeeper-4w5xo-tce-zk-vpc-mcctl              Opaque

b-zookeeper-4w5xo-tce-zk.zk346-group-vpc-host   Opaque

b-zookeeper-dn4ya-tce-zk-tdsql                  Opaque

b-zookeeper-dn4ya-tce-zk.zk346-group-other-host Opaque

i-zookeeper-tce-zk.zk346                        Opaque

i-zookeeper-tce-zk.zk346-group-other            Opaque

i-zookeeper-tce-zk.zk346-group-vpc              Opaque

zookeeper-operator-token-dzjbx                  kubernetes.io/service-account-token

zookeeper-vendor-token-7ksdf                    kubernetes.io/service-account-token              





[root@tcs-10-200-1-133 ~]#  kubectl  get  si -ntce  | grep  zk 

zk.zk346                     zookeeper   zk.zk346                     Ready   42d

zk.zk346-group-other         zookeeper   zk.zk346-group-other         Ready   42d

zk.zk346-group-vpc           zookeeper   zk.zk346-group-vpc           Ready   42d





[root@tcs-10-200-1-133 ~]#  kubectl  get  sb  -ntce  | grep  zk 

NAME                       INSTANCE              SECRET                      EXTERNALID

zk-api3                    zk.zk346              zk-api3                     tce-zk-api3

zk-barad                   zk.zk346              zk-barad                    tce-zk-barad

zk-cbs                     zk.zk346              zk-cbs                      tce-zk-cbs

zk-ops-cmdb                zk.zk346              zk-ops-cmdb                 tce-zk-ops-cmdb

zk-osppro-ntp              zk.zk346              zk-osppro-ntp               tce-zk-osppro-ntp

zk-osppro-yum              zk.zk346              zk-osppro-yum               tce-zk-osppro-yum

zk-psg-50010001            zk.zk346              zk-psg-50010001             tce-zk-psg-50010001

zk-redis                   zk.zk346              zk-redis                    tce-zk-redis          

zk-tcenter-collector       zk.zk346              zk-tcenter-collector        tce-zk-tcenter-collector

zk-tdmq                    zk.zk346              zk-tdmq                     tce-zk-tdmq

zk-tdsql                   zk.zk346-group-other  zk-tdsql                    tce-zk-tdsql

zk-vpc                     zk.zk346-group-vpc    zk-vpc                      tce-zk-vpc    

zk-vpc-dfw                 zk.zk346-group-vpc    zk-vpc-dfw                  tce-zk-vpc-dfw

zk-vpc-mcctl               zk.zk346-group-vpc    zk-vpc-mcctl                tce-zk-vpc-mcctl

zk-yunjing                 zk.zk346              zk-yunjing                  tce-zk-yunjing

zk.zk346-group-other-host  zk.zk346-group-other  zk.zk346-group-other-host   tce-zk.zk346-group-other-host

zk.zk346-group-vpc-host    zk.zk346-group-vpc    zk.zk346-group-vpc-host     tce-zk.zk346-group-vpc-host

zk.zk346-host              zk.zk346              zk.zk346-host               tce-zk.zk346-host 





[root@tcs-10-200-1-133 ~]#  kubectl  get  secret -ntce  | grep  zk

NAME                                                        TYPE 

zk-api3                                                     Opaque

zk-barad                                                    Opaque

zk-cbs                                                      Opaque

zk-ops-cmdb                                                 Opaque

zk-osppro-ntp                                               Opaque

zk-osppro-yum                                               Opaque

zk-psg-50010001                                             Opaque

zk-redis                                                    Opaque

zk-tcenter-collector                                        Opaque

zk-tdmq                                                     Opaque

zk-tdsql                                                    Opaque

zk-vpc                                                      Opaque

zk-vpc-dfw                                                  Opaque

zk-vpc-mcctl                                                Opaque

zk-yunjing                                                  Opaque

zk.zk346-group-other-host                                   Opaque

zk.zk346-group-vpc-host                                     Opaque

zk.zk346-host                                               Opaque



[root@tcs-10-200-1-133 ~]#    get  svc -nsso  | grep zk 

exporter-tce-zk-zk346             ClusterIP      192.168.212.244   <none>          8081/TCP      

exporter-tce-zk-zk346-group-other ClusterIP      192.168.208.241   <none>          8081/TCP      

exporter-tce-zk-zk346-group-vpc   ClusterIP      192.168.241.60    <none>          8081/TCP      

tce-zk-zk346                      LoadBalancer   192.168.238.194   10.200.41.37    2181:45637/TCP

tce-zk-zk346-group-other          LoadBalancer   192.168.234.64    10.200.41.50    2181:42921/TCP

tce-zk-zk346-group-vpc            LoadBalancer   192.168.229.7     10.200.41.54    2181:49573/TCP



[root@tcs-10-200-1-133 ~]#    get  ep   -nsso   |  grep zk 

exporter-tce-zk-zk346                          192.168.3.15:8080 

exporter-tce-zk-zk346-group-other              192.168.3.16:8080 

exporter-tce-zk-zk346-group-vpc                192.168.4.134:8080

tce-zk-zk346                                   10.200.41.37:2181 

tce-zk-zk346-group-other                       10.200.41.50:2181 

tce-zk-zk346-group-vpc                         10.200.41.54:2181 

```







#### 物理机支撑rabbitmq & 容器化rabbitmq 



```sh

[root@tcs-10-200-1-133 ~]#  kubectl  get  app -ntce | grep  product-tcenter-support-mq

product-tcenter-support-mq                               Succeeded   2       2         43d



[root@tcs-10-200-1-133 ~]#  kubectl  get  comp -ntce | grep   mq.mq

mq.mq-1                                                  MiddlewareWorkload

mq.mq-1-group-phy                                        MiddlewareWorkload



[root@tcs-10-200-1-133 ~]#  kubectl  get MiddlewareWorkload -ntce | grep  mq.mq 

mq.mq-1                                           rabbitmq    Ready      43d

mq.mq-1-group-phy                                 rabbitmq    Ready      43d



[root@tcs-10-200-1-133 ~]#  kubectl  get mw  -ntce | grep  mq.mq 

mq.mq-1                                           rabbitmq    Ready      43d

mq.mq-1-group-phy                                 rabbitmq    Ready      43d





================================================================================================

[root@tcs-10-200-1-133 ~]#  kubectl  get   crd  | grep -wE "rabbitmqs"

rabbitmqs.infra.tce.io                        2020-10-02T09:00:28Z



[root@tcs-10-200-1-133 ~]#  kubectl  get rabbitmqs.infra.tce.io   -nsso  | grep mq

tce-cmq-cmq-1   3       3         45d

tce-mq-mq-1     3       3         44d 



[root@tcs-10-200-1-133 ~]#  kubectl  get rabbitmq  -nsso 

NAME            READY   DESIRED   AGE

tce-cmq-cmq-1   3       3         45d

tce-mq-mq-1     3       3         44d



[root@tcs-10-200-1-133 ~]#  kubectl  get serviceplan  | grep  rabbitmq

mq.mq-1                      rabbitmq    43d

mq.mq-1-group-phy            rabbitmq    43d

rabbitmq-advanced            rabbitmq    45d

rabbitmq-standard            rabbitmq    45d





================================================================================================

[root@tcs-10-200-1-133 ~]#  kubectl  get  pod -nssm | grep  -E "rabbitmq"

rabbitmq-operator-b5b46d6f-t5pbz            1/1     Running   0          34d

rabbitmq-operator-b5b46d6f-tm66d            1/1     Running   1          34d

rabbitmq-vendor-6846479c7b-4b7jd            1/1     Running   0          34d

rabbitmq-vendor-6846479c7b-9l57v            1/1     Running   0          34d





[root@tcs-10-200-1-133 ~]#  kubectl  get  pod -nsso | grep  -E "rabbitmq" 

rabbitmq-tce-cmq-cmq-1-0                                         2/2     Running   11         34d

rabbitmq-tce-cmq-cmq-1-1                                         2/2     Running   9          34d

rabbitmq-tce-cmq-cmq-1-2                                         2/2     Running   11         34d

rabbitmq-tce-mq-mq-1-0                                           2/2     Running   24         34d

rabbitmq-tce-mq-mq-1-1                                           2/2     Running   29         34d

rabbitmq-tce-mq-mq-1-2                                           2/2     Running   25         34d



[root@tcs-10-200-1-133 ~]#  kubectl  get svc -nssm  | grep   rabbitmq 

rabbitmq-vendor     ClusterIP      192.168.218.98    <none>         8080/TCP         45d



[root@tcs-10-200-1-133 ~]#    get ep  -nssm  | grep   rabbitmq

rabbitmq-vendor    192.168.1.243:8080,192.168.9.125:8080   45d





================================================================================================

[root@tcs-10-200-1-133 ~]#  kubectl  get  secret  -nssm | grep  -E "rabbitmq"

b-rabbitmq-bvmme-tce-mq-yunjing                                 Opaque

b-rabbitmq-bvmme-tce-mq.mq-1-host                               Opaque

b-rabbitmq-wc57p-tce-mq-as-flora                                Opaque

b-rabbitmq-wc57p-tce-mq-cvm                                     Opaque

b-rabbitmq-wc57p-tce-mq-cvm-notify                              Opaque

b-rabbitmq-wc57p-tce-mq-tsf                                     Opaque

b-rabbitmq-wc57p-tce-mq.mq-1-group-phy-host                     Opaque

i-rabbitmq-tce-mq.mq-1                                          Opaque

i-rabbitmq-tce-mq.mq-1-group-phy                                Opaque

rabbitmq-operator-token-6n45j                                   kubernetes.io/service-account-token

rabbitmq-vendor-token-s6jj2                                     kubernetes.io/service-account-token





[root@tcs-10-200-1-133 ~]#  kubectl  get  si -ntce | grep  rabbitmq

mq.mq-1                      rabbitmq    mq.mq-1                      Ready   43d

mq.mq-1-group-phy            rabbitmq    mq.mq-1-group-phy            Ready   43d



[root@tcs-10-200-1-133 ~]#  kubectl  get  sb -ntce | grep   mq -w

mq-as-flora             mq.mq-1-group-phy  mq-as-flora             tce-mq-as-flora           

mq-cvm                  mq.mq-1-group-phy  mq-cvm                  tce-mq-cvm                

mq-cvm-notify           mq.mq-1-group-phy  mq-cvm-notify           tce-mq-cvm-notify         

mq-tsf                  mq.mq-1-group-phy  mq-tsf                  tce-mq-tsf                

mq-yunjing              mq.mq-1            mq-yunjing              tce-mq-yunjing            

mq.mq-1-group-phy-host  mq.mq-1-group-phy  mq.mq-1-group-phy-host  tce-mq.mq-1-group-phy-host

mq.mq-1-host            mq.mq-1            mq.mq-1-host            tce-mq.mq-1-host         



[root@tcs-10-200-1-133 ~]#  kubectl  get  secret  -ntce | grep  -E "mq" -w

mq-as-flora                                                 Opaque

mq-cvm                                                      Opaque

mq-cvm-notify                                               Opaque

mq-tsf                                                      Opaque

mq-yunjing                                                  Opaque

mq.mq-1-group-phy-host                                      Opaque

mq.mq-1-host                                                Opaque



[root@tcs-10-200-1-133 ~]#  kubectl  get svc -nsso | grep mq  -w

rabbitmq-tce-mq-mq-1                    ClusterIP     None            <none>        5672/TCP

rabbitmq-tce-mq-mq-1-group-phy-out      LoadBalancer  192.168.221.74  10.200.41.37  15672:26301/TCP

rabbitmq-tce-mq-mq-1-group-phy-out-5672 LoadBalancer  192.168.206.25  10.200.41.37  5672:62470/TCP

rabbitmq-tce-mq-mq-1-out  LoadBalancer  192.168.218.27  10.200.41.43  5672:2071/TCP,15672:48961/TCP





[root@tcs-10-200-1-133 ~]#  kubectl  get ep -nsso | grep mq  -w

rabbitmq-tce-mq-mq-1                     10.200.0.133:50770,10.200.0.6:50770,10.200.0.7:50770

rabbitmq-tce-mq-mq-1-group-phy-out       10.200.41.37:15672

rabbitmq-tce-mq-mq-1-group-phy-out-5672  10.200.41.37:5672

rabbitmq-tce-mq-mq-1-out                 10.200.0.133:50770,10.200.0.6:50770,10.200.0.7:50770 +3 more...

```







#### 物理机支撑ces



```bash

[root@tcs-10-200-1-133 ~]#  kubectl  get  app -ntce | grep  product-tcenter-support-ces

product-tcenter-support-ces                              Succeeded   14      14        43d



[root@tcs-10-200-1-133 ~]#  kubectl  get  comp -ntce | grep es -w 

es-amp                                                   MiddlewareWorkload

es-amp-ref                                               MiddlewareWorkload

es-argus2                                                MiddlewareWorkload

es-argus2-ref                                            MiddlewareWorkload

es-barad                                                 MiddlewareWorkload

es-barad-ref                                             MiddlewareWorkload

es-bmppro-document                                       MiddlewareWorkload

es-bmppro-document-ref                                   MiddlewareWorkload

es-cbs                                                   MiddlewareWorkload

es-cbs-ref                                               MiddlewareWorkload

es-cloudaudit                                            MiddlewareWorkload

es-cloudaudit-ref                                        MiddlewareWorkload

es-cvm                                                   MiddlewareWorkload

es-cvm-ref                                               MiddlewareWorkload

es-dmc                                                   MiddlewareWorkload

es-dmc-ref                                               MiddlewareWorkload

es-ocloud-cloudaudit                                     MiddlewareWorkload

es-ocloud-cloudaudit-ref                                 MiddlewareWorkload

es-opargus2                                              MiddlewareWorkload

es-opargus2-ref                                          MiddlewareWorkload

es-psg                                                   MiddlewareWorkload

es-psg-50010001-ref                                      MiddlewareWorkload

es-psg-ref                                               MiddlewareWorkload

es-tdmq                                                  MiddlewareWorkload

es-tdmq-ref                                              MiddlewareWorkload

es-waf                                                   MiddlewareWorkload

es-waf-ref                                               MiddlewareWorkload

es-yunjing                                               MiddlewareWorkload

es-yunjing-ref                                           MiddlewareWorkload



[root@tcs-10-200-1-133 ~]#  kubectl  get MiddlewareWorkload -ntce | grep es -w

es-amp                                            ces         Ready      43d

es-amp-ref                                        ces         Ready      42d

es-argus2                                         ces         Ready      43d

es-argus2-ref                                     ces         Ready      42d

es-barad                                          ces         Ready      43d

es-barad-ref                                      ces         Ready      42d

es-bmppro-document                                ces         Ready      43d

es-bmppro-document-ref                            ces         Ready      42d

es-cbs                                            ces         Ready      43d

es-cbs-ref                                        ces         Ready      37d

es-cloudaudit                                     ces         Ready      43d

es-cloudaudit-ref                                 ces         Ready      42d

es-cvm                                            ces         Ready      43d

es-cvm-ref                                        ces         Ready      42d

es-dmc                                            ces         Ready      38d

es-dmc-ref                                        ces         Ready      29d

es-ocloud-cloudaudit                              ces         Ready      38d

es-ocloud-cloudaudit-ref                          ces         Ready      38d

es-opargus2                                       ces         Ready      43d

es-opargus2-ref                                   ces         Ready      42d

es-psg                                            ces         Ready      43d

es-psg-50010001-ref                               ces         Ready      17d

es-tdmq                                           ces         Ready      38d

es-tdmq-ref                                       ces         Ready      30d

es-waf                                            ces         Ready      43d

es-waf-ref                                        ces         Ready      42d

es-yunjing                                        ces         Ready      38d

es-yunjing-ref                                    ces         Ready      36d



[root@tcs-10-200-1-133 ~]#  kubectl  get mw  -ntce | grep es -w

es-amp                                            ces         Ready      43d

es-amp-ref                                        ces         Ready      42d

es-argus2                                         ces         Ready      43d

es-argus2-ref                                     ces         Ready      42d

es-barad                                          ces         Ready      43d

es-barad-ref                                      ces         Ready      42d

es-bmppro-document                                ces         Ready      43d

es-bmppro-document-ref                            ces         Ready      42d

es-cbs                                            ces         Ready      43d

es-cbs-ref                                        ces         Ready      37d

es-cloudaudit                                     ces         Ready      43d

es-cloudaudit-ref                                 ces         Ready      42d

es-cvm                                            ces         Ready      43d

es-cvm-ref                                        ces         Ready      42d

es-dmc                                            ces         Ready      38d

es-dmc-ref                                        ces         Ready      29d

es-ocloud-cloudaudit                              ces         Ready      38d

es-ocloud-cloudaudit-ref                          ces         Ready      38d

es-opargus2                                       ces         Ready      43d

es-opargus2-ref                                   ces         Ready      42d

es-psg                                            ces         Ready      43d

es-psg-50010001-ref                               ces         Ready      17d

es-tdmq                                           ces         Ready      38d

es-tdmq-ref                                       ces         Ready      30d

es-waf                                            ces         Ready      43d

es-waf-ref                                        ces         Ready      42d

es-yunjing                                        ces         Ready      38d

es-yunjing-ref                                    ces         Ready      36d





================================================================================================

[root@tcs-10-200-1-133 ~]#    get   crd  | grep  -w "ces"

ces.infra.tce.io                              2020-12-22T06:31:05Z



[root@tcs-10-200-1-133 ~]#    get   ces.infra.tce.io  -nsso 

NAME                     VERSION                     SIZE TYPE  CLUSTER              

tce-es-amp               60403                       3    clog  oss-ces1.infra.tce.io

tce-es-argus2            60403                       3    clog  oss-ces2.infra.tce.io

tce-es-barad             50604.20180509.664          3    ctsdb oss-ces2.infra.tce.io

tce-es-bmppro-document   60403                       3    clog  oss-ces1.infra.tce.io

tce-es-cbs               50604.20180509.664          3    clog  oss-ces1.infra.tce.io

tce-es-cloudaudit        60403                       3    clog  oss-ces1.infra.tce.io

tce-es-cvm               60403                       3    clog  oss-ces2.infra.tce.io

tce-es-dmc               60802.20191127.cesf1ae5778  3    clog  oss-ces1.infra.tce.io

tce-es-ocloud-cloudaudit 60403                       3    clog  oss-ces1.infra.tce.io

tce-es-opargus2          60403                       3    clog  oss-ces3.infra.tce.io

tce-es-psg               50604.20180509.664          3    clog  oss-ces3.infra.tce.io

tce-es-tdmq              70501.20200109.ces66bfb173  3    clog  oss-ces2.infra.tce.io

tce-es-waf               60403                       3    clog  oss-ces1.infra.tce.io

tce-es-yunjing           70501.20200109.ces66bfb173  3    clog  oss-ces3.infra.tce.io



[root@tcs-10-200-1-133 ~]#    get ces  -nsso 

NAME                     VERSION                     SIZE TYPE  CLUSTER              

tce-es-amp               60403                       3    clog  oss-ces1.infra.tce.io

tce-es-argus2            60403                       3    clog  oss-ces2.infra.tce.io

tce-es-barad             50604.20180509.664          3    ctsdb oss-ces2.infra.tce.io

tce-es-bmppro-document   60403                       3    clog  oss-ces1.infra.tce.io

tce-es-cbs               50604.20180509.664          3    clog  oss-ces1.infra.tce.io

tce-es-cloudaudit        60403                       3    clog  oss-ces1.infra.tce.io

tce-es-cvm               60403                       3    clog  oss-ces2.infra.tce.io

tce-es-dmc               60802.20191127.cesf1ae5778  3    clog  oss-ces1.infra.tce.io

tce-es-ocloud-cloudaudit 60403                       3    clog  oss-ces1.infra.tce.io

tce-es-opargus2          60403                       3    clog  oss-ces3.infra.tce.io

tce-es-psg               50604.20180509.664          3    clog  oss-ces3.infra.tce.io

tce-es-tdmq              70501.20200109.ces66bfb173  3    clog  oss-ces2.infra.tce.io

tce-es-waf               60403                       3    clog  oss-ces1.infra.tce.io

tce-es-yunjing           70501.20200109.ces66bfb173  3    clog  oss-ces3.infra.tce.io



[root@tcs-10-200-1-133 ~]#  kubectl  get serviceplan  | grep   ces

ces-advanced                 ces         35d

ces-standard                 ces         35d

es-amp                       ces         43d

es-argus2                    ces         43d

es-barad                     ces         43d

es-bmppro-document           ces         43d

es-cbs                       ces         43d

es-cloudaudit                ces         43d

es-cvm                       ces         43d

es-dmc                       ces         38d

es-ocloud-cloudaudit         ces         38d

es-opargus2                  ces         43d

es-psg                       ces         43d

es-tdmq                      ces         38d

es-tdmq-clog-test            ces         30d

es-waf                       ces         43d

es-yunjing                   ces         38d





================================================================================================

[root@tcs-10-200-1-133 ~]#    get  pod -nssm | grep  -E "ces"

ces-operator-84875bb95f-7z2vl               1/1     Running   1          35d

ces-operator-84875bb95f-d79p6               1/1     Running   2          35d

ces-vendor-6dc4764fc-68q65                  1/1     Running   0          35d

ces-vendor-6dc4764fc-gg2ql                  1/1     Running   0          35d



[root@tcs-10-200-1-133 ~]#    get  pod -nsso | grep  -E "ces"

ces-exporter-tce-es-dmc-685fcc449-td4fz                          1/1     Running   0          35d

ces-exporter-tce-es-ocloud-cloudaudit-cd76987f4-s8t4c            1/1     Running   0          35d

ces-exporter-tce-es-tdmq-648b666b57-4bh7z                        1/1     Running   0          35d

ces-exporter-tce-es-yunjing-6c56dfccfc-dwml7                     1/1     Running   0          35d



[root@tcs-10-200-1-133 ~]#  kubectl  get svc -nssm  | grep   es  

ces-vendor   ClusterIP      192.168.210.2     <none>         8080/TCP         35d

oss-ces1     LoadBalancer   192.168.232.19    10.200.41.33   5100:52458/TCP   45d

oss-ces2     LoadBalancer   192.168.225.28    10.200.41.33   5200:10966/TCP   45d

oss-ces3     LoadBalancer   192.168.216.48    10.200.41.33   5300:29382/TCP   45d



[root@tcs-10-200-1-133 ~]#  kubectl  get ep -nssm  | grep   es

ces-vendor                                     192.168.1.194:8080,192.168.6.118:8080   35d

oss-ces1                                       10.200.41.33:5100                       45d

oss-ces2                                       10.200.41.33:5200                       45d

oss-ces3                                       10.200.41.33:5300                       45d





================================================================================================

[root@tcs-10-200-1-133 ~]#  kubectl  get  secret  -nssm | grep  -Ew "es"

b-ces-4twb7-tce-es-ocloud-cloudaudit                            Opaque

b-ces-4twb7-tce-es-ocloud-cloudaudit-host                       Opaque

b-ces-4un8c-tce-es-yunjing                                      Opaque

b-ces-4un8c-tce-es-yunjing-host                                 Opaque

b-ces-603vp-tce-es-argus2                                       Opaque

b-ces-603vp-tce-es-argus2-host                                  Opaque

b-ces-ca0h2-tce-es-opargus2                                     Opaque

b-ces-ca0h2-tce-es-opargus2-host                                Opaque

b-ces-ew8az-tce-es-cvm                                          Opaque

b-ces-ew8az-tce-es-cvm-host                                     Opaque

b-ces-f6pd3-tce-es-dmc                                          Opaque

b-ces-f6pd3-tce-es-dmc-host                                     Opaque

b-ces-o3lcm-tce-es-cloudaudit                                   Opaque

b-ces-o3lcm-tce-es-cloudaudit-host                              Opaque

b-ces-olrn5-tce-es-bmppro-document                              Opaque

b-ces-olrn5-tce-es-bmppro-document-host                         Opaque

b-ces-sg1vq-tce-es-amp                                          Opaque

b-ces-sg1vq-tce-es-amp-host                                     Opaque

b-ces-sookm-tce-es-psg-50010001                                 Opaque

b-ces-sookm-tce-es-psg-host                                     Opaque

b-ces-uz9av-tce-es-barad                                        Opaque

b-ces-uz9av-tce-es-barad-host                                   Opaque

b-ces-vsmup-tce-es-cbs                                          Opaque

b-ces-vsmup-tce-es-cbs-host                                     Opaque

b-ces-vzzih-tce-es-waf                                          Opaque

b-ces-vzzih-tce-es-waf-host                                     Opaque

b-ces-ytrsn-tce-es-tdmq                                         Opaque

b-ces-ytrsn-tce-es-tdmq-host                                    Opaque

i-ces-tce-es-amp                                                Opaque

i-ces-tce-es-argus2                                             Opaque

i-ces-tce-es-barad                                              Opaque

i-ces-tce-es-bmppro-document                                    Opaque

i-ces-tce-es-cbs                                                Opaque

i-ces-tce-es-cloudaudit                                         Opaque

i-ces-tce-es-cvm                                                Opaque

i-ces-tce-es-dmc                                                Opaque

i-ces-tce-es-ocloud-cloudaudit                                  Opaque

i-ces-tce-es-opargus2                                           Opaque

i-ces-tce-es-psg                                                Opaque

i-ces-tce-es-tdmq                                               Opaque

i-ces-tce-es-waf                                                Opaque

i-ces-tce-es-yunjing                                            Opaque



[root@tcs-10-200-1-133 ~]#    get si -ntce | grep -w es

es-amp                       ces         es-amp                       Ready   43d

es-argus2                    ces         es-argus2                    Ready   43d

es-barad                     ces         es-barad                     Ready   43d

es-bmppro-document           ces         es-bmppro-document           Ready   43d

es-cbs                       ces         es-cbs                       Ready   43d

es-cloudaudit                ces         es-cloudaudit                Ready   43d

es-cvm                       ces         es-cvm                       Ready   43d

es-dmc                       ces         es-dmc                       Ready   38d

es-ocloud-cloudaudit         ces         es-ocloud-cloudaudit         Ready   38d

es-opargus2                  ces         es-opargus2                  Ready   43d

es-psg                       ces         es-psg                       Ready   43d

es-tdmq                      ces         es-tdmq                      Ready   35d

es-waf                       ces         es-waf                       Ready   43d

es-yunjing                   ces         es-yunjing                   Ready   35d



[root@tcs-10-200-1-133 ~]#    get sb -ntce | grep -w es

NAME                 INSTANCE             SECRET			   EXTERNALID

es-amp               es-amp               es-amp               tce-es-amp             

es-argus2            es-argus2            es-argus2            tce-es-argus2          

es-barad             es-barad             es-barad             tce-es-barad           

es-bmppro-document   es-bmppro-document   es-bmppro-document   tce-es-bmppro-document 

es-cbs               es-cbs               es-cbs               tce-es-cbs             

es-cloudaudit        es-cloudaudit        es-cloudaudit        tce-es-cloudaudit      

es-cvm               es-cvm               es-cvm               tce-es-cvm             

es-dmc               es-dmc               es-dmc               tce-es-dmc             

es-ocloud-cloudaudit es-ocloud-cloudaudit es-ocloud-cloudaudit tce-es-ocloud-cloudaudit

es-opargus2          es-opargus2          es-opargus2          tce-es-opargus2        

es-psg-50010001      es-psg               es-psg-50010001      tce-es-psg-50010001    

es-tdmq              es-tdmq              es-tdmq              tce-es-tdmq            

es-waf               es-waf               es-waf               tce-es-waf             

es-yunjing           es-yunjing           es-yunjing           tce-es-yunjing  



[root@tcs-10-200-1-133 ~]#  kubectl  get secret -ntce | grep es -w

es-amp                                                      Opaque

es-amp-host                                                 Opaque

es-argus2                                                   Opaque

es-argus2-host                                              Opaque

es-barad                                                    Opaque

es-barad-host                                               Opaque

es-bmppro-document                                          Opaque

es-bmppro-document-host                                     Opaque

es-cbs                                                      Opaque

es-cbs-host                                                 Opaque

es-cloudaudit                                               Opaque

es-cloudaudit-host                                          Opaque

es-cvm                                                      Opaque

es-cvm-host                                                 Opaque

es-dmc                                                      Opaque

es-dmc-host                                                 Opaque

es-ocloud-cloudaudit                                        Opaque

es-ocloud-cloudaudit-host                                   Opaque

es-opargus2                                                 Opaque

es-opargus2-host                                            Opaque

es-psg-50010001                                             Opaque

es-psg-host                                                 Opaque

es-tdmq                                                     Opaque

es-tdmq-host                                                Opaque

es-waf                                                      Opaque

es-waf-host                                                 Opaque

es-yunjing                                                  Opaque

es-yunjing-host                                             Opaque

u-product-tsf-mock-tce-es                                   Opaque



[root@tcs-10-200-1-133 ~]#  kubectl  get svc -nsso  | grep es -w

ces-exporter-tce-es-dmc               ClusterIP     192.168.248.13   <none>        8081/TCP       

ces-exporter-tce-es-ocloud-cloudaudit ClusterIP     192.168.228.219  <none>        8081/TCP       

ces-exporter-tce-es-tdmq              ClusterIP     192.168.252.67   <none>        8081/TCP       

ces-exporter-tce-es-yunjing           ClusterIP     192.168.250.78   <none>        8081/TCP       

ces-tce-es-amp                        LoadBalancer  192.168.242.236  10.200.41.50  12006:48047/TCP

ces-tce-es-argus2                     LoadBalancer  192.168.204.132  10.200.41.37  12004:13867/TCP

ces-tce-es-barad                      LoadBalancer  192.168.251.146  10.200.41.37  12000:52345/TCP

ces-tce-es-bmppro-document            LoadBalancer  192.168.249.43   10.200.41.37  12010:63652/TCP

ces-tce-es-cbs                        LoadBalancer  192.168.223.76   10.200.41.37  12001:45870/TCP

ces-tce-es-cloudaudit                 LoadBalancer  192.168.243.97   10.200.41.37  12009:61895/TCP

ces-tce-es-cvm                        LoadBalancer  192.168.214.159  10.200.41.37  12011:55897/TCP

ces-tce-es-dmc                        LoadBalancer  192.168.233.7    10.200.41.33  12020:62175/TCP

ces-tce-es-ocloud-cloudaudit          LoadBalancer  192.168.219.139  10.200.41.33  12014:48518/TCP

ces-tce-es-opargus2                   LoadBalancer  192.168.209.207  10.200.41.50  12005:47940/TCP

ces-tce-es-psg                        LoadBalancer  192.168.243.123  10.200.41.50  12002:47186/TCP

ces-tce-es-tdmq                       LoadBalancer  192.168.203.50   10.200.41.33  12015:21392/TCP

ces-tce-es-waf                        LoadBalancer  192.168.244.152  10.200.41.37  12012:28821/TCP

ces-tce-es-yunjing                    LoadBalancer  192.168.218.180  10.200.41.37  12019:20368/TCP



[root@tcs-10-200-1-133 ~]#  kubectl  get ep -nsso  | grep es -w

ces-exporter-tce-es-dmc                        192.168.6.121:9114

ces-exporter-tce-es-ocloud-cloudaudit          192.168.6.122:9114

ces-exporter-tce-es-tdmq                       192.168.1.210:9114

ces-exporter-tce-es-yunjing                    192.168.1.208:9114

ces-tce-es-amp                                 10.200.41.50:12006

ces-tce-es-argus2                              10.200.41.37:12004

ces-tce-es-barad                               10.200.41.37:12000

ces-tce-es-bmppro-document                     10.200.41.37:12010

ces-tce-es-cbs                                 10.200.41.37:12001

ces-tce-es-cloudaudit                          10.200.41.37:12009

ces-tce-es-cvm                                 10.200.41.37:12011

ces-tce-es-dmc                                 10.200.41.33:12020

ces-tce-es-ocloud-cloudaudit                   10.200.41.33:12014

ces-tce-es-opargus2                            10.200.41.50:12005

ces-tce-es-psg                                 10.200.41.50:12002

ces-tce-es-tdmq                                10.200.41.33:12015

ces-tce-es-waf                                 10.200.41.37:12012

ces-tce-es-yunjing                             10.200.41.37:12019

```







#### 物理机支撑tdsql



```bash

[root@tcs-10-200-1-133 ~]#  kubectl  get  app -ntce | grep  product-tcenter-support-tdsql

product-tcenter-support-tdsql                            Succeeded   5       5         43d



[root@tcs-10-200-1-133 ~]#  kubectl  get  comp -ntce | grep  -w "db.db"

db.db-1                                                  MiddlewareWorkload

db.db-2                                                  MiddlewareWorkload

db.db-3                                                  MiddlewareWorkload

db.db-4                                                  MiddlewareWorkload

db.db-5                                                  MiddlewareWorkload



[root@tcs-10-200-1-133 ~]#  kubectl  get  MiddlewareWorkload -ntce | grep  -w "db.db"

db.db-1                                           tdsql       Ready      43d

db.db-2                                           tdsql       Ready      43d

db.db-3                                           tdsql       Ready      43d

db.db-4                                           tdsql       Ready      38d

db.db-5                                           tdsql       Ready      38d



[root@tcs-10-200-1-133 ~]#  kubectl  get  mw  -ntce | grep  -w "db.db"

db.db-1                                           tdsql       Ready      43d

db.db-2                                           tdsql       Ready      43d

db.db-3                                           tdsql       Ready      43d

db.db-4                                           tdsql       Ready      38d

db.db-5                                           tdsql       Ready      38d





================================================================================================

[root@tcs-10-200-1-133 ~]#  kubectl  get   crd  | grep  -w "tdsqls"

tdsqls.infra.tce.io                           2020-12-22T06:29:59Z



[root@tcs-10-200-1-133 ~]#  kubectl  get tdsqls.infra.tce.io -nsso 

NAME                            VERSION   SIZE   CLUSTER                   PHASE   ENDPOINT                                               SETNAME           

monitoring-grafana-oam-tdsql    5.7.17    3      oss-tdsql1.infra.tce.io   Ready   10.200.0.134:15262,10.200.0.8:15262,10.200.1.6:15262   set_1604714101_65 

service-brokers-tdsql-credis-db 5.7.17    3      oss-tdsql1.infra.tce.io   Ready   10.200.0.134:15260,10.200.0.8:15260,10.200.1.6:15260   set_1601712728_25 

sso-tdsql-infrastore-db         5.7.17    3      oss-tdsql1.infra.tce.io   Ready   10.200.0.134:15263,10.200.0.8:15263,10.200.1.6:15263   set_1610000989_117

tce-db.db-1                     5.7.17    3      oss-tdsql1.infra.tce.io   Ready   10.200.0.134:15259,10.200.0.8:15259,10.200.1.6:15259   set_1601712532_23 

tce-db.db-2                     5.7.17    3      oss-tdsql1.infra.tce.io   Ready   10.200.0.134:15261,10.200.0.8:15261,10.200.1.6:15261   set_1601713643_29 

tce-db.db-3                     5.7.17    3      oss-tdsql1.infra.tce.io   Ready   10.200.0.134:15258,10.200.0.8:15258,10.200.1.6:15258   set_1601712445_19 

tce-db.db-4                     5.7.17    3      oss-tdsql1.infra.tce.io   Ready   10.200.0.134:15264,10.200.0.8:15264,10.200.1.6:15264   set_1609227382_95 

tce-db.db-5                     5.7.17    3      oss-tdsql1.infra.tce.io   Ready   10.200.0.134:15267,10.200.0.8:15267,10.200.1.6:15267   set_1609227420_97 



[root@tcs-10-200-1-133 ~]#  kubectl  get tdsql  -nsso 

NAME                              VERSION   SIZE   CLUSTER                   PHASE   ENDPOINT                                               SETNAME              AGE

monitoring-grafana-oam-tdsql      5.7.17    3      oss-tdsql1.infra.tce.io   Ready   10.200.0.134:15262,10.200.0.8:15262,10.200.1.6:15262   set_1604714101_65    44d

service-brokers-tdsql-credis-db   5.7.17    3      oss-tdsql1.infra.tce.io   Ready   10.200.0.134:15260,10.200.0.8:15260,10.200.1.6:15260   set_1601712728_25    44d

sso-tdsql-infrastore-db           5.7.17    3      oss-tdsql1.infra.tce.io   Ready   10.200.0.134:15263,10.200.0.8:15263,10.200.1.6:15263   set_1610000989_117   29d

tce-db.db-1                       5.7.17    3      oss-tdsql1.infra.tce.io   Ready   10.200.0.134:15259,10.200.0.8:15259,10.200.1.6:15259   set_1601712532_23    43d

tce-db.db-2                       5.7.17    3      oss-tdsql1.infra.tce.io   Ready   10.200.0.134:15261,10.200.0.8:15261,10.200.1.6:15261   set_1601713643_29    44d

tce-db.db-3                       5.7.17    3      oss-tdsql1.infra.tce.io   Ready   10.200.0.134:15258,10.200.0.8:15258,10.200.1.6:15258   set_1601712445_19    44d

tce-db.db-4                       5.7.17    3      oss-tdsql1.infra.tce.io   Ready   10.200.0.134:15264,10.200.0.8:15264,10.200.1.6:15264   set_1609227382_95    38d

tce-db.db-5                       5.7.17    3      oss-tdsql1.infra.tce.io   Ready   10.200.0.134:15267,10.200.0.8:15267,10.200.1.6:15267   set_1609227420_97    38d



[root@tcs-10-200-1-133 ~]#  kubectl  get serviceplan  | grep  tdsql

db.db-1                      tdsql       43d

db.db-2                      tdsql       43d

db.db-3                      tdsql       43d

db.db-4                      tdsql       38d

db.db-5                      tdsql       38d

grafana-oam-tdsql            tdsql       43d

tdsql-advanced               tdsql       45d

tdsql-infrastore-db          tdsql       29d

tdsql-standard               tdsql       45d





================================================================================================

[root@tcs-10-200-1-133 ~]#  kubectl  get pod -nsso | grep    tdsql 

oss-tdsql1-exporter-6fb55f65cf-mxzxx    	1/1     Running   0  		 45d



[root@tcs-10-200-1-133 ~]#  kubectl  get pod -nssm | grep    tdsql 

tdsql-operator-7f74c85ff9-fhxdr             1/1     Running   3          45d

tdsql-operator-7f74c85ff9-t58mn             1/1     Running   1          45d

tdsql-vendor-6ff74fbdb5-6n54b               1/1     Running   0          45d

tdsql-vendor-6ff74fbdb5-lqqzr               1/1     Running   0          45d



[root@tcs-10-200-1-133 ~]#  kubectl  get svc -nssm | grep    tdsql 

oss-tdsql1     LoadBalancer   192.168.240.79    10.200.41.38   8081:32298/TCP   45d

tdsql-vendor   ClusterIP      192.168.196.7     <none>         8080/TCP         45d



[root@tcs-10-200-1-133 ~]#  kubectl  get ep  -nssm | grep    tdsql 

oss-tdsql1                                     10.200.41.38:8081                       45d

tdsql-vendor                                   192.168.3.230:8080,192.168.4.106:8080   45d





================================================================================================

[root@tcs-10-200-1-133 ~]#  kubectl  get secret  -nssm | grep  tdsql  | grep -v “b-”

i-tdsql-monitoring-grafana-oam-tdsql      Opaque                                19     44d

i-tdsql-service-brokers-tdsql-credis-db   Opaque                                19     44d

i-tdsql-sso-tdsql-infrastore-db           Opaque                                22     29d

oss-tdsql1                                Opaque                                1      45d

tdsql-operator-token-sgrmz                kubernetes.io/service-account-token   3      45d

tdsql-vendors-token-4cn9l                 kubernetes.io/service-account-token   3      45d



[root@tcs-10-200-1-133 ~]#  kubectl  get si -ntce | grep  db.db

db.db-1                      tdsql       db.db-1                      Ready   43d

db.db-2                      tdsql       db.db-2                      Ready   43d

db.db-3                      tdsql       db.db-3                      Ready   43d

db.db-4                      tdsql       db.db-4                      Ready   38d

db.db-5                      tdsql       db.db-5                      Ready   38d



[root@tcs-10-200-1-133 ~]#  kubectl  get sb -ntce | grep  db.db | grep  host 

db.db-1-host    db.db-1    db.db-1-host    tce-db.db-1-host 

db.db-2-host    db.db-2    db.db-2-host    tce-db.db-2-host 

db.db-3-host    db.db-3    db.db-3-host    tce-db.db-3-host 

db.db-4-host    db.db-4    db.db-4-host    tce-db.db-4-host 

db.db-5-host    db.db-5    db.db-5-host    tce-db.db-5-host

数量较多。。。



[root@tcs-10-200-1-133 ~]#  kubectl  get secret  -ntce | grep  db.db

db.db-1-host        Opaque      16     43d

db.db-2-host        Opaque      16     43d

db.db-3-host        Opaque      16     43d

db.db-4-host        Opaque      14     38d

db.db-5-host        Opaque      14     38d

数量较多。。。



[root@tcs-10-200-1-133 ~]#  kubectl  get svc -nsso  | grep  db.db

tdsql-tce-db-db-1   LoadBalancer   192.168.224.229   10.200.41.37    22001:19234/TCP

tdsql-tce-db-db-2   LoadBalancer   192.168.212.215   10.200.41.37    22003:18702/TCP

tdsql-tce-db-db-3   LoadBalancer   192.168.218.133   10.200.41.37    22005:19616/TCP

tdsql-tce-db-db-4   LoadBalancer   192.168.199.72    10.200.41.37    22007:43232/TCP

tdsql-tce-db-db-5   LoadBalancer   192.168.227.215   10.200.41.37    22009:10265/TCP



[root@tcs-10-200-1-133 ~]#  kubectl  get ep  -nsso | grep    tdsql 

oss-tdsql1-exporter                            192.168.3.81:8080   

tdsql-monitoring-grafana-oam-tdsql             10.200.41.37:37527  

tdsql-service-brokers-tdsql-credis-db          10.200.41.55:36883  

tdsql-sso-tdsql-infrastore-db                  10.200.41.37:65531  

tdsql-tce-db-db-1                              10.200.41.37:22001  

tdsql-tce-db-db-2                              10.200.41.37:22003  

tdsql-tce-db-db-3                              10.200.41.37:22005  

tdsql-tce-db-db-4                              10.200.41.37:22007  

tdsql-tce-db-db-5                              10.200.41.37:22009  

```







#### 物理机支撑credis



```bash

[root@tcs-10-200-1-133 ~]#  kubectl  get  app -ntce | grep  product-tcenter-support-credis

product-tcenter-support-credis                           Succeeded   36      36        43d



[root@tcs-10-200-1-133 ~]#    get  comp -ntce | grep   ckv

ckv-amp                                                  MiddlewareWorkload

ckv-amp-ref                                              MiddlewareWorkload

ckv-api2                                                 MiddlewareWorkload

ckv-api2-ref                                             MiddlewareWorkload

ckv-argus2                                               MiddlewareWorkload

ckv-argus2-adp                                           MiddlewareWorkload

ckv-argus2-adp-ref                                       MiddlewareWorkload

ckv-argus2-ref                                           MiddlewareWorkload

ckv-barad                                                MiddlewareWorkload

ckv-barad-ref                                            MiddlewareWorkload

ckv-bmppro-document                                      MiddlewareWorkload

ckv-bmppro-document-ref                                  MiddlewareWorkload

ckv-bsp                                                  MiddlewareWorkload

ckv-bsp-ref                                              MiddlewareWorkload

ckv-cam-log-yunapi                                       MiddlewareWorkload

ckv-cam-log-yunapi-ref                                   MiddlewareWorkload

ckv-cas                                                  MiddlewareWorkload

ckv-cas-ref                                              MiddlewareWorkload

ckv-cbs-monitor                                          MiddlewareWorkload

ckv-cbs-monitor-ref                                      MiddlewareWorkload

ckv-cls-cgi                                              MiddlewareWorkload

ckv-cls-cgi-ref                                          MiddlewareWorkload

ckv-cls-janus                                            MiddlewareWorkload

ckv-cls-janus-ref                                        MiddlewareWorkload

ckv-cls-logsearch                                        MiddlewareWorkload

ckv-cls-logsearch-ref                                    MiddlewareWorkload

ckv-cls-mr                                               MiddlewareWorkload

ckv-cls-mr-ref                                           MiddlewareWorkload

ckv-cls-zeus                                             MiddlewareWorkload

ckv-cls-zeus-ref                                         MiddlewareWorkload

ckv-cvm-opcvm                                            MiddlewareWorkload

ckv-cvm-opcvm-ref                                        MiddlewareWorkload

ckv-cvm-vstation                                         MiddlewareWorkload

ckv-cvm-vstation-ref                                     MiddlewareWorkload

ckv-kms                                                  MiddlewareWorkload

ckv-kms-ref                                              MiddlewareWorkload

ckv-nms                                                  MiddlewareWorkload

ckv-nms-ref                                              MiddlewareWorkload

ckv-ocloud-sig                                           MiddlewareWorkload

ckv-ocloud-sig-ref                                       MiddlewareWorkload

ckv-opargus2                                             MiddlewareWorkload

ckv-opargus2-ref                                         MiddlewareWorkload

ckv-ops-cmdb                                             MiddlewareWorkload

ckv-ops-cmdb-ref                                         MiddlewareWorkload

ckv-osppro-adp                                           MiddlewareWorkload

ckv-osppro-adp-ref                                       MiddlewareWorkload

ckv-osppro-package-manager                               MiddlewareWorkload

ckv-osppro-package-manager-ref                           MiddlewareWorkload

ckv-osppro-workflow-engine                               MiddlewareWorkload

ckv-osppro-workflow-engine-ref                           MiddlewareWorkload

ckv-osppro-workload                                      MiddlewareWorkload

ckv-osppro-workload-ref                                  MiddlewareWorkload

ckv-psg                                                  MiddlewareWorkload

ckv-psg-50010001-ref                                     MiddlewareWorkload

ckv-psg-ref                                              MiddlewareWorkload

ckv-sig                                                  MiddlewareWorkload

ckv-sig-ref                                              MiddlewareWorkload

ckv-tcenter-collector                                    MiddlewareWorkload

ckv-tcenter-collector-ref                                MiddlewareWorkload

ckv-tsf                                                  MiddlewareWorkload

ckv-tsf-ref                                              MiddlewareWorkload

ckv-vpc                                                  MiddlewareWorkload

ckv-vpc-ref                                              MiddlewareWorkload

ckv-waf                                                  MiddlewareWorkload

ckv-waf-ai-engine                                        MiddlewareWorkload

ckv-waf-ai-engine-ref                                    MiddlewareWorkload

ckv-waf-ref                                              MiddlewareWorkload

ckv-waf-sparta                                           MiddlewareWorkload

ckv-waf-sparta-ref                                       MiddlewareWorkload

ckv-yunjing                                              MiddlewareWorkload

ckv-yunjing-ref                                          MiddlewareWorkload

ckv-zhiyun                                               MiddlewareWorkload

ckv-zhiyun-ref                                           MiddlewareWorkload

dbsql-tcenter-ckv--oss-ref                               MiddlewareWorkload



[root@tcs-10-200-1-133 ~]#  kubectl  get MiddlewareWorkload -ntce | grep  ckv

ckv-amp                                           credis      Ready      43d

ckv-amp-ref                                       credis      Ready      42d

ckv-api2                                          credis      Ready      43d

ckv-api2-ref                                      credis      Ready      42d

ckv-argus2                                        credis      Ready      43d

ckv-argus2-adp                                    credis      Ready      43d

ckv-argus2-adp-ref                                credis      Ready      42d

ckv-argus2-ref                                    credis      Ready      42d

ckv-barad                                         credis      Ready      43d

ckv-barad-ref                                     credis      Ready      42d

ckv-bmppro-document                               credis      Ready      43d

ckv-bmppro-document-ref                           credis      Ready      42d

ckv-bsp                                           credis      Ready      43d

ckv-bsp-ref                                       credis      Ready      42d

ckv-cam-log-yunapi                                credis      Ready      37d

ckv-cam-log-yunapi-ref                            credis      Ready      35d

ckv-cas                                           credis      Ready      43d

ckv-cas-ref                                       credis      Ready      42d

ckv-cbs-monitor                                   credis      Ready      43d

ckv-cbs-monitor-ref                               credis      Ready      42d

ckv-cls-cgi                                       credis      Ready      37d

ckv-cls-cgi-ref                                   credis      Ready      20d

ckv-cls-janus                                     credis      Ready      37d

ckv-cls-janus-ref                                 credis      Ready      20d

ckv-cls-logsearch                                 credis      Ready      37d

ckv-cls-logsearch-ref                             credis      Ready      20d

ckv-cls-mr                                        credis      Ready      37d

ckv-cls-mr-ref                                    credis      Ready      20d

ckv-cls-zeus                                      credis      Ready      37d

ckv-cls-zeus-ref                                  credis      Ready      20d

ckv-cvm-opcvm                                     credis      Ready      43d

ckv-cvm-opcvm-ref                                 credis      Ready      42d

ckv-cvm-vstation                                  credis      Ready      43d

ckv-cvm-vstation-ref                              credis      Ready      42d

ckv-kms                                           credis      Ready      43d

ckv-kms-ref                                       credis      Ready      42d

ckv-nms                                           credis      Ready      38d

ckv-nms-ref                                       credis      Ready      38d

ckv-ocloud-sig                                    credis      Ready      38d

ckv-ocloud-sig-ref                                credis      Ready      38d

ckv-opargus2                                      credis      Ready      43d

ckv-opargus2-ref                                  credis      Ready      42d

ckv-ops-cmdb                                      credis      Ready      43d

ckv-ops-cmdb-ref                                  credis      Ready      42d

ckv-osppro-adp                                    credis      Ready      43d

ckv-osppro-adp-ref                                credis      Ready      42d

ckv-osppro-package-manager                        credis      Ready      38d

ckv-osppro-package-manager-ref                    credis      Ready      37d

ckv-osppro-workflow-engine                        credis      Ready      37d

ckv-osppro-workflow-engine-ref                    credis      Ready      37d

ckv-osppro-workload                               credis      Ready      37d

ckv-osppro-workload-ref                           credis      Ready      37d

ckv-psg                                           credis      Ready      43d

ckv-psg-50010001-ref                              credis      Ready      17d

ckv-sig                                           credis      Ready      43d

ckv-sig-ref                                       credis      Ready      43d

ckv-tcenter-collector                             credis      Ready      14d

ckv-tcenter-collector-ref                         credis      Ready      21d

ckv-tsf                                           credis      Ready      43d

ckv-tsf-ref                                       credis      Ready      42d

ckv-vpc                                           credis      Ready      43d

ckv-vpc-ref                                       credis      Ready      42d

ckv-waf                                           credis      Ready      43d

ckv-waf-ai-engine                                 credis      Ready      43d

ckv-waf-ai-engine-ref                             credis      Ready      42d

ckv-waf-ref                                       credis      Ready      42d

ckv-waf-sparta                                    credis      Ready      43d

ckv-waf-sparta-ref                                credis      Ready      42d

ckv-yunjing                                       credis      Ready      43d

ckv-yunjing-ref                                   credis      Ready      42d

ckv-zhiyun                                        credis      Ready      43d

ckv-zhiyun-ref                                    credis      Ready      42d

dbsql-tcenter-ckv--oss-ref                        tdsql       Ready      42d





================================================================================================

[root@tcs-10-200-1-133 ~]#  kubectl  get crd   -A |  grep credis

credis.infra.tce.io                           2020-12-22T06:33:05Z



[root@tcs-10-200-1-133 ~]#  kubectl  get credis.infra.tce.io -A 

NAMESPACE   NAME                             STATUS   AGE

sso         tce-ckv-amp                      Ready    44d

sso         tce-ckv-api2                     Ready    44d

sso         tce-ckv-argus2                   Ready    44d

sso         tce-ckv-argus2-adp               Ready    44d

sso         tce-ckv-barad                    Ready    44d

sso         tce-ckv-bmppro-document          Ready    44d

sso         tce-ckv-bsp                      Ready    44d

sso         tce-ckv-cam-log-yunapi           Ready    37d

sso         tce-ckv-cas                      Ready    44d

sso         tce-ckv-cbs-monitor              Ready    44d

sso         tce-ckv-cls-cgi                  Ready    37d

sso         tce-ckv-cls-janus                Ready    37d

sso         tce-ckv-cls-logsearch            Ready    37d

sso         tce-ckv-cls-mr                   Ready    37d

sso         tce-ckv-cls-zeus                 Ready    37d

sso         tce-ckv-cvm-opcvm                Ready    44d

sso         tce-ckv-cvm-vstation             Ready    44d

sso         tce-ckv-kms                      Ready    44d

sso         tce-ckv-nms                      Ready    38d

sso         tce-ckv-ocloud-sig               Ready    38d

sso         tce-ckv-opargus2                 Ready    44d

sso         tce-ckv-ops-cmdb                 Ready    44d

sso         tce-ckv-osppro-adp               Ready    44d

sso         tce-ckv-osppro-package-manager   Ready    38d

sso         tce-ckv-osppro-workflow-engine   Ready    37d

sso         tce-ckv-osppro-workload          Ready    37d

sso         tce-ckv-psg                      Ready    44d

sso         tce-ckv-sig                      Ready    44d

sso         tce-ckv-tcenter-collector        Ready    14d

sso         tce-ckv-tsf                      Ready    44d

sso         tce-ckv-vpc                      Ready    44d

sso         tce-ckv-waf                      Ready    44d

sso         tce-ckv-waf-ai-engine            Ready    44d

sso         tce-ckv-waf-sparta               Ready    44d

sso         tce-ckv-yunjing                  Ready    44d

sso         tce-ckv-zhiyun                   Ready    44d



[root@tcs-10-200-1-133 ~]#  kubectl  get  credis -A

NAMESPACE   NAME                             STATUS   AGE

sso         tce-ckv-amp                      Ready    44d

sso         tce-ckv-api2                     Ready    44d

sso         tce-ckv-argus2                   Ready    44d

sso         tce-ckv-argus2-adp               Ready    44d

sso         tce-ckv-barad                    Ready    44d

sso         tce-ckv-bmppro-document          Ready    44d

sso         tce-ckv-bsp                      Ready    44d

sso         tce-ckv-cam-log-yunapi           Ready    37d

sso         tce-ckv-cas                      Ready    44d

sso         tce-ckv-cbs-monitor              Ready    44d

sso         tce-ckv-cls-cgi                  Ready    37d

sso         tce-ckv-cls-janus                Ready    37d

sso         tce-ckv-cls-logsearch            Ready    37d

sso         tce-ckv-cls-mr                   Ready    37d

sso         tce-ckv-cls-zeus                 Ready    37d

sso         tce-ckv-cvm-opcvm                Ready    44d

sso         tce-ckv-cvm-vstation             Ready    44d

sso         tce-ckv-kms                      Ready    44d

sso         tce-ckv-nms                      Ready    38d

sso         tce-ckv-ocloud-sig               Ready    38d

sso         tce-ckv-opargus2                 Ready    44d

sso         tce-ckv-ops-cmdb                 Ready    44d

sso         tce-ckv-osppro-adp               Ready    44d

sso         tce-ckv-osppro-package-manager   Ready    38d

sso         tce-ckv-osppro-workflow-engine   Ready    37d

sso         tce-ckv-osppro-workload          Ready    37d

sso         tce-ckv-psg                      Ready    44d

sso         tce-ckv-sig                      Ready    44d

sso         tce-ckv-tcenter-collector        Ready    14d

sso         tce-ckv-tsf                      Ready    44d

sso         tce-ckv-vpc                      Ready    44d

sso         tce-ckv-waf                      Ready    44d

sso         tce-ckv-waf-ai-engine            Ready    44d

sso         tce-ckv-waf-sparta               Ready    44d

sso         tce-ckv-yunjing                  Ready    44d

sso         tce-ckv-zhiyun                   Ready    44d



[root@tcs-10-200-1-133 ~]#  kubectl  get serviceplan  | grep   credis

ckv-amp                      credis      43d

ckv-api2                     credis      43d

ckv-argus2                   credis      43d

ckv-argus2-adp               credis      43d

ckv-barad                    credis      43d

ckv-bmppro-document          credis      43d

ckv-bsp                      credis      43d

ckv-cam-log-yunapi           credis      38d

ckv-cas                      credis      43d

ckv-cbs-monitor              credis      43d

ckv-cls-cgi                  credis      37d

ckv-cls-janus                credis      37d

ckv-cls-logsearch            credis      37d

ckv-cls-mr                   credis      37d

ckv-cls-zeus                 credis      37d

ckv-cvm-opcvm                credis      43d

ckv-cvm-vstation             credis      43d

ckv-kms                      credis      43d

ckv-nms                      credis      38d

ckv-ocloud-sig               credis      38d

ckv-opargus2                 credis      43d

ckv-ops-cmdb                 credis      43d

ckv-osppro-adp               credis      43d

ckv-osppro-package-manager   credis      38d

ckv-osppro-workflow-engine   credis      37d

ckv-osppro-workload          credis      37d

ckv-psg                      credis      43d

ckv-sig                      credis      43d

ckv-tcenter-collector        credis      14d

ckv-tsf                      credis      43d

ckv-vpc                      credis      43d

ckv-waf                      credis      43d

ckv-waf-ai-engine            credis      43d

ckv-waf-sparta               credis      43d

ckv-yunjing                  credis      43d

ckv-zhiyun                   credis      43d

credis-advanced              credis      45d

credis-standard              credis      45d







================================================================================================

[root@tcs-10-200-1-133 ~]#  kubectl  get pod -nssm | grep credis 

credis-operator-5c79fc7879-s54fv            1/1     Running   2          28d

credis-vendor-6d744d695b-64qb6              1/1     Running   0          28d

credis-vendor-6d744d695b-wxfzq              1/1     Running   0          28d



[root@tcs-10-200-1-133 ~]#  kubectl  get pod -nsso | grep credis 

credis-exporter-tce-ckv-amp-68d4c7b4cb-vvwmf                     1/1     Running   0          28d

credis-exporter-tce-ckv-api2-7fb6cb4466-44vt6                    1/1     Running   0          28d

credis-exporter-tce-ckv-argus2-adp-845d785cc9-dxrvn              1/1     Running   0          28d

credis-exporter-tce-ckv-argus2-f4f4bb7d6-b582p                   1/1     Running   0          28d

credis-exporter-tce-ckv-barad-585dc775f6-q6kb2                   1/1     Running   0          28d

credis-exporter-tce-ckv-bmppro-document-679b67b975-cn8pj         1/1     Running   0          28d

credis-exporter-tce-ckv-bsp-574555cb7f-kcs46                     1/1     Running   0          28d

credis-exporter-tce-ckv-cam-log-yunapi-77cb8f7c56-zlc9v          1/1     Running   0          28d

credis-exporter-tce-ckv-cas-59998d5d88-xhgch                     1/1     Running   0          28d

credis-exporter-tce-ckv-cbs-monitor-698794ddb7-2hv7b             1/1     Running   0          28d

credis-exporter-tce-ckv-cls-cgi-fbf5dc46d-nfxbq                  1/1     Running   0          28d

credis-exporter-tce-ckv-cls-janus-56f7b9b7f9-q922m               1/1     Running   0          28d

credis-exporter-tce-ckv-cls-logsearch-77c6565587-chdfn           1/1     Running   0          28d

credis-exporter-tce-ckv-cls-mr-58bb5f64bc-twmxx                  1/1     Running   0          28d

credis-exporter-tce-ckv-cls-zeus-76bdc6bff8-57wv9                1/1     Running   0          28d

credis-exporter-tce-ckv-cvm-opcvm-85879d6769-dnfcx               1/1     Running   0          28d

credis-exporter-tce-ckv-cvm-vstation-5649bc476b-9tvkk            1/1     Running   0          28d

credis-exporter-tce-ckv-kms-59c7445b97-vgw4z                     1/1     Running   0          28d

credis-exporter-tce-ckv-nms-96f5cfb87-5qdkt                      1/1     Running   0          28d

credis-exporter-tce-ckv-ocloud-sig-68d6dd7878-tpnlr              1/1     Running   0          28d

credis-exporter-tce-ckv-opargus2-6c54fcc4bf-9jlhc                1/1     Running   0          28d

credis-exporter-tce-ckv-ops-cmdb-c97cdfffc-g5gns                 1/1     Running   0          28d

credis-exporter-tce-ckv-osppro-adp-6747d4c6f4-fk5cr              1/1     Running   0          28d

credis-exporter-tce-ckv-osppro-package-manager-76c4f67c5-hf928   1/1     Running   0          28d

credis-exporter-tce-ckv-osppro-workflow-engine-877f54bfb-rb576   1/1     Running   0          28d

credis-exporter-tce-ckv-osppro-workload-7b4bc454d7-khjwq         1/1     Running   0          28d

credis-exporter-tce-ckv-psg-75fb7994db-xz6b6                     1/1     Running   0          28d

credis-exporter-tce-ckv-sig-c5447d9bc-sdbkr                      1/1     Running   0          28d

credis-exporter-tce-ckv-tcenter-collector-8496c59f54-c6wln       1/1     Running   0          14d

credis-exporter-tce-ckv-tsf-7b5498547b-klgbh                     1/1     Running   0          28d

credis-exporter-tce-ckv-vpc-d546c484b-7t2qs                      1/1     Running   0          28d

credis-exporter-tce-ckv-waf-6d5bf79bdd-92csv                     1/1     Running   0          28d

credis-exporter-tce-ckv-waf-ai-engine-5dc5b576b4-n4qjz           1/1     Running   0          28d

credis-exporter-tce-ckv-waf-sparta-7d8f97b769-8t8lb              1/1     Running   0          28d

credis-exporter-tce-ckv-yunjing-6969fcdfbb-4sz9g                 1/1     Running   0          28d

credis-exporter-tce-ckv-zhiyun-69894ccbfb-8dd8j                  1/1     Running   0          28d



[root@tcs-10-200-1-133 ~]#  kubectl  get svc  -nssm | grep credis 

credis-vendor     ClusterIP      192.168.242.205   <none>         8080/TCP         45d

oss-credis1       LoadBalancer   192.168.208.223   10.200.41.33   6100:58060/TCP   45d



[root@tcs-10-200-1-133 ~]#  kubectl  get ep   -nssm | grep credis 

credis-vendor                                  192.168.5.65:8080,192.168.9.214:8080    45d

oss-credis1                                    10.200.41.33:6100                       45d





================================================================================================

[root@tcs-10-200-1-133 ~]#  kubectl  get secret -nssm | grep credis

i-credis-tce-ckv-amp                               Opaque                                16     44d

i-credis-tce-ckv-api2                              Opaque                                16     44d

i-credis-tce-ckv-argus2                            Opaque                                16     44d

i-credis-tce-ckv-argus2-adp                        Opaque                                16     44d

i-credis-tce-ckv-barad                             Opaque                                16     44d

i-credis-tce-ckv-bmppro-document                   Opaque                                16     44d

i-credis-tce-ckv-bsp                               Opaque                                16     44d

i-credis-tce-ckv-cam-log-yunapi                    Opaque                                16     37d

i-credis-tce-ckv-cas                               Opaque                                16     44d

i-credis-tce-ckv-cbs-monitor                       Opaque                                16     44d

i-credis-tce-ckv-cls-cgi                           Opaque                                16     37d

i-credis-tce-ckv-cls-janus                         Opaque                                16     37d

i-credis-tce-ckv-cls-logsearch                     Opaque                                16     37d

i-credis-tce-ckv-cls-mr                            Opaque                                16     37d

i-credis-tce-ckv-cls-zeus                          Opaque                                16     37d

i-credis-tce-ckv-cvm-opcvm                         Opaque                                16     44d

i-credis-tce-ckv-cvm-vstation                      Opaque                                16     44d

i-credis-tce-ckv-kms                               Opaque                                16     44d

i-credis-tce-ckv-nms                               Opaque                                16     38d

i-credis-tce-ckv-ocloud-sig                        Opaque                                16     38d

i-credis-tce-ckv-opargus2                          Opaque                                16     44d

i-credis-tce-ckv-ops-cmdb                          Opaque                                16     44d

i-credis-tce-ckv-osppro-adp                        Opaque                                16     44d

i-credis-tce-ckv-osppro-package-manager            Opaque                                16     38d

i-credis-tce-ckv-osppro-workflow-engine            Opaque                                16     37d

i-credis-tce-ckv-osppro-workload                   Opaque                                16     37d

i-credis-tce-ckv-psg                               Opaque                                16     44d

i-credis-tce-ckv-sig                               Opaque                                16     44d

i-credis-tce-ckv-tcenter-collector                 Opaque                                16     14d

i-credis-tce-ckv-tsf                               Opaque                                16     44d

i-credis-tce-ckv-vpc                               Opaque                                16     44d

i-credis-tce-ckv-waf                               Opaque                                16     44d

i-credis-tce-ckv-waf-ai-engine                     Opaque                                16     44d

i-credis-tce-ckv-waf-sparta                        Opaque                                16     44d

i-credis-tce-ckv-yunjing                           Opaque                                16     44d

i-credis-tce-ckv-zhiyun                            Opaque                                16     44d

i-tdsql-service-brokers-tdsql-credis-db            Opaque                                19     44d

oss-credis1                                        Opaque                                1      45d

credis-operator-token-hghqc                        kubernetes.io/service-account-token   3      45d

credis-vendor-token-x547s                          kubernetes.io/service-account-token   3      45d



[root@tcs-10-200-1-133 ~]#  kubectl  get si   -ntce  | grep credis

ckv-amp                      credis      ckv-amp                      Ready   43d

ckv-api2                     credis      ckv-api2                     Ready   43d

ckv-argus2                   credis      ckv-argus2                   Ready   43d

ckv-argus2-adp               credis      ckv-argus2-adp               Ready   43d

ckv-barad                    credis      ckv-barad                    Ready   43d

ckv-bmppro-document          credis      ckv-bmppro-document          Ready   43d

ckv-bsp                      credis      ckv-bsp                      Ready   43d

ckv-cam-log-yunapi           credis      ckv-cam-log-yunapi           Ready   37d

ckv-cas                      credis      ckv-cas                      Ready   43d

ckv-cbs-monitor              credis      ckv-cbs-monitor              Ready   43d

ckv-cls-cgi                  credis      ckv-cls-cgi                  Ready   37d

ckv-cls-janus                credis      ckv-cls-janus                Ready   37d

ckv-cls-logsearch            credis      ckv-cls-logsearch            Ready   37d

ckv-cls-mr                   credis      ckv-cls-mr                   Ready   37d

ckv-cls-zeus                 credis      ckv-cls-zeus                 Ready   37d

ckv-cvm-opcvm                credis      ckv-cvm-opcvm                Ready   43d

ckv-cvm-vstation             credis      ckv-cvm-vstation             Ready   43d

ckv-kms                      credis      ckv-kms                      Ready   43d

ckv-nms                      credis      ckv-nms                      Ready   38d

ckv-ocloud-sig               credis      ckv-ocloud-sig               Ready   38d

ckv-opargus2                 credis      ckv-opargus2                 Ready   43d

ckv-ops-cmdb                 credis      ckv-ops-cmdb                 Ready   43d

ckv-osppro-adp               credis      ckv-osppro-adp               Ready   43d

ckv-osppro-package-manager   credis      ckv-osppro-package-manager   Ready   38d

ckv-osppro-workflow-engine   credis      ckv-osppro-workflow-engine   Ready   37d

ckv-osppro-workload          credis      ckv-osppro-workload          Ready   37d

ckv-psg                      credis      ckv-psg                      Ready   43d

ckv-sig                      credis      ckv-sig                      Ready   43d

ckv-tcenter-collector        credis      ckv-tcenter-collector        Ready   14d

ckv-tsf                      credis      ckv-tsf                      Ready   43d

ckv-vpc                      credis      ckv-vpc                      Ready   43d

ckv-waf                      credis      ckv-waf                      Ready   43d

ckv-waf-ai-engine            credis      ckv-waf-ai-engine            Ready   43d

ckv-waf-sparta               credis      ckv-waf-sparta               Ready   43d

ckv-yunjing                  credis      ckv-yunjing                  Ready   43d

ckv-zhiyun                   credis      ckv-zhiyun                   Ready   43d



[root@tcs-10-200-1-133 ~]#  kubectl  get sb   -ntce  | grep ckv |  grep -v host 

ckv-amp                ckv-amp                 ckv-amp                tce-ckv-amp              

ckv-api2               ckv-api2                ckv-api2               tce-ckv-api2             

ckv-argus2             ckv-argus2              ckv-argus2             tce-ckv-argus2           

ckv-argus2-adp         ckv-argus2-adp          ckv-argus2-adp         tce-ckv-argus2-adp       

ckv-barad              ckv-barad               ckv-barad              tce-ckv-barad            

ckv-bmppro-document    ckv-bmppro-document     ckv-bmppro-document    tce-ckv-bmppro-document  

ckv-bsp                ckv-bsp                 ckv-bsp                tce-ckv-bsp              

ckv-cam-log-yunapi     ckv-cam-log-yunapi      ckv-cam-log-yunapi     tce-ckv-cam-log-yunapi   

ckv-cas                ckv-cas                 ckv-cas                tce-ckv-cas              

ckv-cbs-monitor        ckv-cbs-monitor         ckv-cbs-monitor        tce-ckv-cbs-monitor      

ckv-cls-cgi            ckv-cls-cgi             ckv-cls-cgi            tce-ckv-cls-cgi          

ckv-cls-janus          ckv-cls-janus           ckv-cls-janus          tce-ckv-cls-janus        

ckv-cls-logsearch      ckv-cls-logsearch       ckv-cls-logsearch      tce-ckv-cls-logsearch    

ckv-cls-mr             ckv-cls-mr              ckv-cls-mr             tce-ckv-cls-mr           

ckv-cls-zeus           ckv-cls-zeus            ckv-cls-zeus           tce-ckv-cls-zeus         

ckv-cvm-opcvm          ckv-cvm-opcvm           ckv-cvm-opcvm          tce-ckv-cvm-opcvm        

ckv-cvm-vstation       ckv-cvm-vstation        ckv-cvm-vstation       tce-ckv-cvm-vstation     

ckv-kms                ckv-kms                 ckv-kms                tce-ckv-kms              

ckv-nms                ckv-nms                 ckv-nms                tce-ckv-nms              

ckv-ocloud-sig         ckv-ocloud-sig          ckv-ocloud-sig         tce-ckv-ocloud-sig       

ckv-opargus2           ckv-opargus2            ckv-opargus2           tce-ckv-opargus2         

ckv-ops-cmdb           ckv-ops-cmdb            ckv-ops-cmdb           tce-ckv-ops-cmdb         

ckv-osppro-adp         ckv-osppro-adp          ckv-osppro-adp         tce-ckv-osppro-adp       

ckv-osppro-workload    ckv-osppro-workload     ckv-osppro-workload    tce-ckv-osppro-workload  

ckv-psg-50010001       ckv-psg                 ckv-psg-50010001       tce-ckv-psg-50010001     

ckv-sig                ckv-sig                 ckv-sig                tce-ckv-sig              

ckv-tcenter-collector  ckv-tcenter-collector   ckv-tcenter-collector  tce-ckv-tcenter-collector

ckv-tsf                ckv-tsf                 ckv-tsf                tce-ckv-tsf              

ckv-vpc                ckv-vpc                 ckv-vpc                tce-ckv-vpc              

ckv-waf                ckv-waf                 ckv-waf                tce-ckv-waf              

ckv-waf-ai-engine      ckv-waf-ai-engine       ckv-waf-ai-engine      tce-ckv-waf-ai-engine    

ckv-waf-sparta         ckv-waf-sparta          ckv-waf-sparta         tce-ckv-waf-sparta       

ckv-yunjing            ckv-yunjing             ckv-yunjing            tce-ckv-yunjing          

ckv-zhiyun             ckv-zhiyun              ckv-zhiyun             tce-ckv-zhiyun 



[root@tcs-10-200-1-133 ~]#  kubectl  get secret -ntce  | grep ckv |  grep -v host 

ckv-amp                             Opaque                                20     113d

ckv-api2                            Opaque                                20     125d

ckv-argus2                          Opaque                                20     113d

ckv-argus2-adp                      Opaque                                20     113d

ckv-barad                           Opaque                                20     124d

ckv-bmppro-document                 Opaque                                20     99d

ckv-bsp                             Opaque                                20     124d

ckv-cam-log-yunapi                  Opaque                                20     35d

ckv-cas                             Opaque                                20     125d

ckv-cbs-monitor                     Opaque                                20     124d

ckv-cls-cgi                         Opaque                                20     20d

ckv-cls-janus                       Opaque                                20     20d

ckv-cls-logsearch                   Opaque                                20     20d

ckv-cls-mr                          Opaque                                20     20d

ckv-cls-zeus                        Opaque                                20     20d

ckv-cvm-opcvm                       Opaque                                20     122d

ckv-cvm-vstation                    Opaque                                20     122d

ckv-kms                             Opaque                                20     107d

ckv-nms                             Opaque                                20     38d

ckv-ocloud-sig                      Opaque                                20     38d

ckv-opargus2                        Opaque                                20     114d

ckv-ops-cmdb                        Opaque                                20     124d

ckv-osppro-adp                      Opaque                                20     124d

ckv-osppro-package-manager          Opaque                                20     37d

ckv-osppro-workflow-engine          Opaque                                20     37d

ckv-osppro-workload                 Opaque                                20     37d

ckv-psg-50010001                    Opaque                                20     17d

ckv-sig                             Opaque                                20     103d

ckv-tcenter-collector               Opaque                                20     14d

ckv-tsf                             Opaque                                20     108d

ckv-vpc                             Opaque                                20     124d

ckv-waf                             Opaque                                20     113d

ckv-waf-ai-engine                   Opaque                                20     113d

ckv-waf-sparta                      Opaque                                20     113d

ckv-yunjing                         Opaque                                20     113d

ckv-zhiyun                          Opaque                                20     124d

dbsql-tcenter-ckv--oss              Opaque                                17     42d

dbsql-tcenter-ckv-oss               Opaque                                9      124d



[root@tcs-10-200-1-133 ~]#  kubectl  get svc -nsso   | grep ckv  

credis-tce-ckv-amp                     LoadBalancer   192.168.227.112   10.200.41.37    12002:1545/TCP 

credis-tce-ckv-api2                    LoadBalancer   192.168.198.185   10.200.41.37    12003:57594/TCP

credis-tce-ckv-argus2                  LoadBalancer   192.168.210.188   10.200.41.50    12004:58449/TCP

credis-tce-ckv-argus2-adp              LoadBalancer   192.168.209.36    10.200.41.37    12027:34657/TCP

credis-tce-ckv-barad                   LoadBalancer   192.168.225.229   10.200.41.37    12005:24161/TCP

credis-tce-ckv-bmppro-document         LoadBalancer   192.168.224.69    10.200.41.37    12030:63809/TCP

credis-tce-ckv-bsp                     LoadBalancer   192.168.222.63    10.200.41.37    12037:57523/TCP

credis-tce-ckv-cam-log-yunapi          LoadBalancer   192.168.230.224   10.200.41.37    12055:23148/TCP

credis-tce-ckv-cas                     LoadBalancer   192.168.217.251   10.200.41.37    12006:58416/TCP

credis-tce-ckv-cbs-monitor             LoadBalancer   192.168.219.14    10.200.41.37    12007:16518/TCP

credis-tce-ckv-cls-cgi                 LoadBalancer   192.168.210.94    10.200.41.37    12058:59967/TCP

credis-tce-ckv-cls-janus               LoadBalancer   192.168.253.178   10.200.41.37    12054:50112/TCP

credis-tce-ckv-cls-logsearch           LoadBalancer   192.168.241.215   10.200.41.37    12060:62567/TCP

credis-tce-ckv-cls-mr                  LoadBalancer   192.168.235.105   10.200.41.37    12059:42221/TCP

credis-tce-ckv-cls-zeus                LoadBalancer   192.168.214.238   10.200.41.33    12053:16174/TCP

credis-tce-ckv-cvm-opcvm               LoadBalancer   192.168.220.154   10.200.41.37    12031:6664/TCP 

credis-tce-ckv-cvm-vstation            LoadBalancer   192.168.210.214   10.200.41.37    12033:31980/TCP

credis-tce-ckv-kms                     LoadBalancer   192.168.232.254   10.200.41.37    12014:36935/TCP

credis-tce-ckv-nms                     LoadBalancer   192.168.222.217   10.200.41.37    12046:20481/TCP

credis-tce-ckv-ocloud-sig              LoadBalancer   192.168.201.249   10.200.41.37    12049:26434/TCP

credis-tce-ckv-opargus2                LoadBalancer   192.168.249.117   10.200.41.37    12015:29206/TCP

credis-tce-ckv-ops-cmdb                LoadBalancer   192.168.245.214   10.200.41.37    12016:12554/TCP

credis-tce-ckv-osppro-adp              LoadBalancer   192.168.221.254   10.200.41.37    12028:26246/TCP

credis-tce-ckv-osppro-package-manager  LoadBalancer   192.168.202.63    10.200.41.37    12053:51194/TCP

credis-tce-ckv-osppro-workflow-engine  LoadBalancer   192.168.242.57    10.200.41.37    12052:39247/TCP

credis-tce-ckv-osppro-workload         LoadBalancer   192.168.251.127   10.200.41.37    12051:17369/TCP

credis-tce-ckv-psg                     LoadBalancer   192.168.243.107   10.200.41.37    12017:32404/TCP

credis-tce-ckv-sig                     LoadBalancer   192.168.247.211   10.200.41.37    12018:31595/TCP

credis-tce-ckv-tcenter-collector       LoadBalancer   192.168.240.4     10.200.41.37    12062:1681/TCP 

credis-tce-ckv-tsf                     LoadBalancer   192.168.238.250   10.200.41.37    12020:52743/TCP

credis-tce-ckv-vpc                     LoadBalancer   192.168.209.252   10.200.41.37    12047:52286/TCP

credis-tce-ckv-waf                     LoadBalancer   192.168.217.255   10.200.41.37    12021:47971/TCP

credis-tce-ckv-waf-ai-engine           LoadBalancer   192.168.224.78    10.200.41.37    12041:27303/TCP

credis-tce-ckv-waf-sparta              LoadBalancer   192.168.248.81    10.200.41.37    12042:21541/TCP

credis-tce-ckv-yunjing                 LoadBalancer   192.168.229.166   10.200.41.37    12022:30863/TCP

credis-tce-ckv-zhiyun                  LoadBalancer   192.168.224.253   10.200.41.37    12023:62898/TCP



[root@tcs-10-200-1-133 ~]#  kubectl  get ep  -nsso   | grep ckv  

credis-tce-ckv-amp                             10.200.41.37:12002

credis-tce-ckv-api2                            10.200.41.37:12003

credis-tce-ckv-argus2                          10.200.41.50:12004

credis-tce-ckv-argus2-adp                      10.200.41.37:12027

credis-tce-ckv-barad                           10.200.41.37:12005

credis-tce-ckv-bmppro-document                 10.200.41.37:12030

credis-tce-ckv-bsp                             10.200.41.37:12037

credis-tce-ckv-cam-log-yunapi                  10.200.41.37:12055

credis-tce-ckv-cas                             10.200.41.37:12006

credis-tce-ckv-cbs-monitor                     10.200.41.37:12007

credis-tce-ckv-cls-cgi                         10.200.41.37:12058

credis-tce-ckv-cls-janus                       10.200.41.37:12054

credis-tce-ckv-cls-logsearch                   10.200.41.37:12060

credis-tce-ckv-cls-mr                          10.200.41.37:12059

credis-tce-ckv-cls-zeus                        10.200.41.33:12053

credis-tce-ckv-cvm-opcvm                       10.200.41.37:12031

credis-tce-ckv-cvm-vstation                    10.200.41.37:12033

credis-tce-ckv-kms                             10.200.41.37:12014

credis-tce-ckv-nms                             10.200.41.37:12046

credis-tce-ckv-ocloud-sig                      10.200.41.37:12049

credis-tce-ckv-opargus2                        10.200.41.37:12015

credis-tce-ckv-ops-cmdb                        10.200.41.37:12016

credis-tce-ckv-osppro-adp                      10.200.41.37:12028

credis-tce-ckv-osppro-package-manager          10.200.41.37:12053

credis-tce-ckv-osppro-workflow-engine          10.200.41.37:12052

credis-tce-ckv-osppro-workload                 10.200.41.37:12051

credis-tce-ckv-psg                             10.200.41.37:12017

credis-tce-ckv-sig                             10.200.41.37:12018

credis-tce-ckv-tcenter-collector               10.200.41.37:12062

credis-tce-ckv-tsf                             10.200.41.37:12020

credis-tce-ckv-vpc                             10.200.41.37:12047

credis-tce-ckv-waf                             10.200.41.37:12021

credis-tce-ckv-waf-ai-engine                   10.200.41.37:12041

credis-tce-ckv-waf-sparta                      10.200.41.37:12042

credis-tce-ckv-yunjing                         10.200.41.37:12022

credis-tce-ckv-zhiyun                          10.200.41.37:12023

```







#### 容器化支撑kafka



```sh

[root@tcs-10-201-1-133 ~]#  kubectl  get  app -ntce  |  grep kafka

[root@tcs-10-201-1-133 ~]#



[root@tcs-10-201-1-133 ~]#  kubectl  get comp -ntce | grep kafka

kafka-argus2-adp-ref                                     MiddlewareWorkload

kafka-argus2-ref                                         MiddlewareWorkload

kafka-barad-ref                                          MiddlewareWorkload

kafka-cam-ref                                            MiddlewareWorkload

kafka-cbs-ref                                            MiddlewareWorkload

kafka-cmdb-ref                                           MiddlewareWorkload

kafka-dts-ref                                            MiddlewareWorkload

kafka-fileserver-ref                                     MiddlewareWorkload

kafka-nms-ref                                            MiddlewareWorkload

kafka-opargus2-ref                                       MiddlewareWorkload

kafka-osppro-adp-ref                                     MiddlewareWorkload

kafka-psg-50010001-ref                                   MiddlewareWorkload

kafka-psg-50010002-ref                                   MiddlewareWorkload

kafka-psg-ref                                            MiddlewareWorkload

kafka-tcenter-ocloud-platform-ref                        MiddlewareWorkload

kafka-tcenter-platform-ref                               MiddlewareWorkload

kafka-tdsql-ref                                          MiddlewareWorkload

kafka-waf-ref                                            MiddlewareWorkload

kafka-yunjing-ref                                        MiddlewareWorkload

kafka.kafka-1                                            MiddlewareWorkload

kafka.kafka-1-group-other                                MiddlewareWorkload





[root@tcs-10-201-1-133 ~]#  kubectl  get MiddlewareWorkload  -ntce | grep kafka

kafka-argus2-adp-ref                              kafka       Ready   34d

kafka-argus2-ref                                  kafka       Ready   34d

kafka-barad-ref                                   kafka       Ready   34d

kafka-cam-ref                                     kafka       Ready   31d

kafka-cbs-ref                                     kafka       Ready   30d

kafka-cmdb-ref                                    kafka       Ready   34d

kafka-dts-ref                                     kafka       Ready   24d

kafka-fileserver-ref                              kafka       Ready   34d

kafka-nms-ref                                     kafka       Ready   31d

kafka-opargus2-ref                                kafka       Ready   34d

kafka-osppro-adp-ref                              kafka       Ready   34d

kafka-psg-50010001-ref                            kafka       Ready   16d

kafka-psg-50010002-ref                            kafka       Ready   16d

kafka-tcenter-ocloud-platform-ref                 kafka       Ready   31d

kafka-tcenter-platform-ref                        kafka       Ready   34d

kafka-tdsql-ref                                   kafka       Ready   34d

kafka-waf-ref                                     kafka       Ready   34d

kafka-yunjing-ref                                 kafka       Ready   30d

kafka.kafka-1                                     kafka       Ready   35d

kafka.kafka-1-group-other                         kafka       Ready   35d





[root@tcs-10-201-1-133 ~]#  kubectl  get mw   -ntce | grep kafka

kafka-argus2-adp-ref                              kafka       Ready   34d

kafka-argus2-ref                                  kafka       Ready   34d

kafka-barad-ref                                   kafka       Ready   34d

kafka-cam-ref                                     kafka       Ready   31d

kafka-cbs-ref                                     kafka       Ready   30d

kafka-cmdb-ref                                    kafka       Ready   34d

kafka-dts-ref                                     kafka       Ready   24d

kafka-fileserver-ref                              kafka       Ready   34d

kafka-nms-ref                                     kafka       Ready   31d

kafka-opargus2-ref                                kafka       Ready   34d

kafka-osppro-adp-ref                              kafka       Ready   34d

kafka-psg-50010001-ref                            kafka       Ready   16d

kafka-psg-50010002-ref                            kafka       Ready   16d

kafka-tcenter-ocloud-platform-ref                 kafka       Ready   31d

kafka-tcenter-platform-ref                        kafka       Ready   34d

kafka-tdsql-ref                                   kafka       Ready   34d

kafka-waf-ref                                     kafka       Ready   34d

kafka-yunjing-ref                                 kafka       Ready   30d

kafka.kafka-1                                     kafka       Ready   35d

kafka.kafka-1-group-other                         kafka       Ready   35d





================================================================================================

[root@tcs-10-201-1-133 ~]#  kubectl  get crd  -A | grep kafka 

kafkas.infra.tce.io                           2020-10-02T13:42:23Z



[root@tcs-10-201-1-133 ~]#  kubectl  get  kafkas.infra.tce.io -nsso 

NAME                            READY   DESIRED   AGE

tce-kafka-kafka-1               3       3         36d

tce-kafka-kafka-1-group-other   3       3         36d



[root@tcs-10-201-1-133 ~]#  kubectl  get kafka -nsso 

NAME                            READY   DESIRED   AGE

tce-kafka-kafka-1               3       3         36d

tce-kafka-kafka-1-group-other   3       3         36d



[root@tcs-10-200-1-133 ~]#  kubectl  get serviceplan  | grep    kafka 

kafka-advanced               kafka       45d

kafka-standard               kafka       45d

kafka.kafka-1                kafka       43d

kafka.kafka-1-group-other    kafka       43d





================================================================================================

[root@tcs-10-201-1-133 ~]#  kubectl  get pod -nssm  | grep kafka 

kafka-operator-5cdff9b85d-97tc6             1/1     Running   4          36d

kafka-operator-5cdff9b85d-plf7n             1/1     Running   3          36d

kafka-vendor-c5b5954c6-8dtcb                1/1     Running   0          36d

kafka-vendor-c5b5954c6-s6r2s                1/1     Running   0          36d



[root@tcs-10-201-1-133 ~]#  kubectl  get pod -nsso  | grep kafka

kafka-tce-kafka-kafka-1-0                                         1/1     Running

kafka-tce-kafka-kafka-1-1                                         1/1     Running

kafka-tce-kafka-kafka-1-2                                         1/1     Running

kafka-tce-kafka-kafka-1-exporter-68c6f94b6f-xkwrb                 1/1     Running

kafka-tce-kafka-kafka-1-group-other-0                             1/1     Running

kafka-tce-kafka-kafka-1-group-other-1                             1/1     Running

kafka-tce-kafka-kafka-1-group-other-2                             1/1     Running

kafka-tce-kafka-kafka-1-group-other-exporter-84d9b786-5lt49       1/1     Running



[root@tcs-10-201-1-133 ~]#  kubectl  get svc -nssm   | grep kafka 

kafka-operator   ClusterIP      192.168.245.114   <none>         8080/TCP         36d

kafka-vendor     ClusterIP      192.168.248.174   <none>         8080/TCP         36d



[root@tcs-10-201-1-133 ~]#  kubectl  get ep -nssm   | grep kafka 

kafka-operator   192.168.16.39:8080,192.168.18.46:8080   36d

kafka-vendor     192.168.16.18:8080,192.168.18.38:8080   36d





================================================================================================

[root@tcs-10-201-1-133 ~]#    get  secret -nssm | grep kafka | grep  -v  "b-"

i-kafka-tce-kafka.kafka-1               Opaque                                6      36d

i-kafka-tce-kafka.kafka-1-group-other   Opaque                                6      36d

kafka-operator-token-xcd6t              kubernetes.io/service-account-token   3      36d

kafka-service-vendor-token-5t6qx        kubernetes.io/service-account-token   3      36d



[root@tcs-10-201-1-133 ~]#  kubectl  get  si -ntce | grep kafka

kafka.kafka-1                kafka       kafka.kafka-1                Ready   35d

kafka.kafka-1-group-other    kafka       kafka.kafka-1-group-other    Ready   35d



[root@tcs-10-201-1-133 ~]#  kubectl  get  sb -ntce | grep kafka

kafka-argus2            kafka.kafka-1   kafka-argus2             tce-kafka-argus2          

kafka-argus2-adp        kafka.kafka-1   kafka-argus2-adp         tce-kafka-argus2-adp      

kafka-barad             kafka.kafka-1   kafka-barad              tce-kafka-barad           

kafka-cam               kafka.kafka-1   kafka-cam                tce-kafka-cam             

kafka-cbs               kafka.kafka-1   kafka-cbs                tce-kafka-cbs             

kafka-cmdb              kafka.kafka-1   kafka-cmdb               tce-kafka-cmdb            

kafka-dts               kafka.kafka-1   kafka-dts                tce-kafka-dts             

kafka-fileserver        kafka.kafka-1   kafka-fileserver         tce-kafka-fileserver      

kafka-nms               kafka.kafka-1   kafka-nms                tce-kafka-nms             

kafka-opargus2          kafka.kafka-1   kafka-opargus2           tce-kafka-opargus2        

kafka-osppro-adp        kafka.kafka-1   kafka-osppro-adp         tce-kafka-osppro-adp      

kafka-psg-50010001      kafka.kafka-1   kafka-psg-50010001       tce-kafka-psg-50010001    

kafka-psg-50010002      kafka.kafka-1   kafka-psg-50010002       tce-kafka-psg-50010002    

kafka-tcenter-platform  kafka.kafka-1   kafka-tcenter-platform   tce-kafka-tcenter-platform

kafka-yunjing           kafka.kafka-1   kafka-yunjing            tce-kafka-yunjing         

kafka.kafka-1-host      kafka.kafka-1   kafka.kafka-1-host       tce-kafka.kafka-1-host    

...



[root@tcs-10-200-1-133 ~]#  kubectl  get secret  -ntce | grep   kafka 

kafka-argus2                         Opaque              12     119d

kafka-argus2-adp                     Opaque              12     116d

kafka-barad                          Opaque              12     122d

kafka-cam                            Opaque              12     35d

kafka-cbs                            Opaque              12     37d

kafka-cmdb                           Opaque              12     122d

kafka-fileserver                     Opaque              12     122d

kafka-nms                            Opaque              12     38d

kafka-opargus2                       Opaque              12     114d

kafka-osppro-adp                     Opaque              12     122d

kafka-psg-50010001                   Opaque              13     17d

kafka-tcenter-ocloud-platform        Opaque              12     38d

kafka-tcenter-platform               Opaque              12     122d

kafka-tdsql                          Opaque              12     121d

kafka-waf                            Opaque              12     122d

kafka-yunjing                        Opaque              12     36d

kafka.kafka-1-group-other-host       Opaque              11     43d

kafka.kafka-1-host                   Opaque              11     43d



[root@tcs-10-200-1-133 ~]#  kubectl  get svc -nsso |  grep kafka 

kafka-tce-kafka-kafka-1-group-other            ClusterIP      None              <none>         9092/TCP 

kafka-tce-kafka-kafka-1-group-other-out  LoadBalancer   192.168.195.141   10.200.41.40   9092:3996/TCP 

kafka-tce-kafka-kafka-1-group-other-exporter   ClusterIP      192.168.198.152   <none>         8080/TCP 

kafka-tce-kafka-kafka-1                        ClusterIP      None              <none>         9092/TCP 

kafka-tce-kafka-kafka-1-out              LoadBalancer   192.168.204.187   10.200.41.43   9092:60939/TCP

kafka-tce-kafka-kafka-1-exporter               ClusterIP      192.168.237.223   <none>         8080/TCP 



[root@tcs-10-200-1-133 ~]#  kubectl  get ep  -nsso |  grep kafka  | grep -v cls

kafka-tce-kafka-kafka-1-group-other            10.200.0.6:9990,10.200.1.135:9990,10.200.1.5:9990

kafka-tce-kafka-kafka-1-group-other-out        10.200.0.6:9990,10.200.1.135:9990,10.200.1.5:9990

kafka-tce-kafka-kafka-1-group-other-exporter   192.168.3.159:8080 

kafka-tce-kafka-kafka-1                        10.200.0.6:9639,10.200.0.7:9639,10.200.1.135:9639

kafka-tce-kafka-kafka-1-out                    10.200.0.6:9639,10.200.0.7:9639,10.200.1.135:9639

kafka-tce-kafka-kafka-1-exporter               192.168.3.160:8080 

```







#### 容器化支撑mongodb



```bash

[root@tcs-10-201-1-133 ~]#  kubectl  get  app -ntce  |  grep mongo

[root@tcs-10-201-1-133 ~]#



[root@tcs-10-201-1-133 ~]#  kubectl  get comp -ntce | grep  mongo

mongodb-base                                             MiddlewareWorkload

mongodb-ops-cmdb-ref                                     MiddlewareWorkload

mongodb-waf-ccdata-ref                                   MiddlewareWorkload

mongodb-waf-conf-ref                                     MiddlewareWorkload

mongodb-waf-payloads-ref                                 MiddlewareWorkload

mongodb-waf-ref                                          MiddlewareWorkload



[root@tcs-10-201-1-133 ~]#  kubectl  get MiddlewareWorkload  -ntce | grep  mongo

mongodb-base                                      mongo       Ready   35d

mongodb-ops-cmdb-ref                              mongo       Ready   30d

mongodb-waf-ccdata-ref                            mongo       Ready   34d

mongodb-waf-conf-ref                              mongo       Ready   34d

mongodb-waf-payloads-ref                          mongo       Ready   34d

mongodb-waf-ref                                   mongo       Ready   34d



[root@tcs-10-201-1-133 ~]#  kubectl  get mw  -ntce | grep  mongo

mongodb-base                                      mongo       Ready   35d

mongodb-ops-cmdb-ref                              mongo       Ready   30d

mongodb-waf-ccdata-ref                            mongo       Ready   34d

mongodb-waf-conf-ref                              mongo       Ready   34d

mongodb-waf-payloads-ref                          mongo       Ready   34d

mongodb-waf-ref                                   mongo       Ready   34d





================================================================================================

[root@tcs-10-201-1-133 ~]#  kubectl  get crd  -A | grep   mongo  

mongoes.infra.tce.io                          2020-10-02T13:42:36Z



[root@tcs-10-201-1-133 ~]#  kubectl  get mongoes.infra.tce.io  -nsso 

NAME               TYPE           MONGO VERSION   STATUS   AGE

tce-mongodb-base   ShardCluster   3.6.3           Ready    35d



[root@tcs-10-201-1-133 ~]#    get mongo -nsso 

NAME               TYPE           MONGO VERSION   STATUS   AGE

tce-mongodb-base   ShardCluster   3.6.3           Ready    35d



[root@tcs-10-200-1-133 ~]#  kubectl  get serviceplan  | grep   mongo 

mongo-advanced               mongo       45d

mongo-standard               mongo       45d

mongodb-base                 mongo       43d





================================================================================================

[root@tcs-10-201-1-133 ~]#  kubectl  get pod -nssm  | grep  mongo 

mongo-operator-58d64748b5-smmgx             1/1     Running   0          35d

mongo-vendor-598fb68cd7-kkvcg               1/1     Running   0          36d

mongo-vendor-598fb68cd7-nzhph               1/1     Running   0          36d



[root@tcs-10-201-1-133 ~]#  kubectl  get pod -nsso  | grep mongo 

cfgsvr-tcemongodbbase-0                       2/2       Running

cfgsvr-tcemongodbbase-1                       2/2       Running

cfgsvr-tcemongodbbase-2                       2/2       Running

mongos-tcemongodbbase-694b6d749-28dbk         2/2       Running

mongos-tcemongodbbase-694b6d749-dnptq         2/2       Running

mongos-tcemongodbbase-694b6d749-vhb4t         2/2       Running

shard-tcemongodbbase-trq0it0t-0               2/2       Running

shard-tcemongodbbase-trq0it0t-1               2/2       Running

shard-tcemongodbbase-trq0it0t-2               2/2       Running



[root@tcs-10-201-1-133 ~]#  kubectl  get svc -nssm   | grep  mongo 

mongo-vendor     ClusterIP      192.168.228.13    <none>         8080/TCP         36d



[root@tcs-10-201-1-133 ~]#  kubectl  get ep  -nssm   | grep  mongo 

mongo-vendor     192.168.16.17:8080,192.168.18.35:8080   36d





================================================================================================

[root@tcs-10-200-1-133 ~]#    get  secret -nssm | grep mongo  | grep  -v  "b-mongo"

i-mongo-tce-mongodb-base     Opaque                                8      44d

mongo-operator-token-5qzjl   kubernetes.io/service-account-token   3      45d

mongo-vendor-token-5k968     kubernetes.io/service-account-token   3      45d



[root@tcs-10-200-1-133 ~]#    get  si -ntce  | grep mongo  

mongodb-base                 mongo       mongodb-base                 Ready   43d



[root@tcs-10-200-1-133 ~]#    get  sb -ntce  | grep mongo  

mongodb-base-host      mongodb-base   mongodb-base-host      tce-mongodb-base-host   

mongodb-ops-cmdb       mongodb-base   mongodb-ops-cmdb       tce-mongodb-ops-cmdb    

mongodb-waf            mongodb-base   mongodb-waf            tce-mongodb-waf         

mongodb-waf-ccdata     mongodb-base   mongodb-waf-ccdata     tce-mongodb-waf-ccdata  

mongodb-waf-conf       mongodb-base   mongodb-waf-conf       tce-mongodb-waf-conf    

mongodb-waf-payloads   mongodb-base   mongodb-waf-payloads   tce-mongodb-waf-payloads



[root@tcs-10-200-1-133 ~]#  kubectl  get secret  -ntce | grep   mongo 

mongodb-base-host                   Opaque               11     43d

mongodb-ops-cmdb                    Opaque               15     37d

mongodb-waf                         Opaque               15     42d

mongodb-waf-ccdata                  Opaque               15     42d

mongodb-waf-conf                    Opaque               15     42d

mongodb-waf-payloads                Opaque               15     42d



[root@tcs-10-200-1-133 ~]#    get  svc -nsso  | grep mongo  

cfgsvr-tcemongodbbase           ClusterIP      None              <none>          27019/TCP      

mongos-tcemongodbbase           LoadBalancer   192.168.247.224   10.200.41.40    27017:47404/TCP

shard-tcemongodbbase-trq0it0t   ClusterIP      None              <none>          27018/TCP 



[root@tcs-10-200-1-133 ~]#    get  ep -nsso  | grep mongo  

cfgsvr-tcemongodbbase           192.168.3.10:27019,192.168.3.8:27019,192.168.3.9:27019             44d

mongos-tcemongodbbase           192.168.3.12:27017,192.168.4.129:27017,192.168.9.105:27017         44d

shard-tcemongodbbase-trq0it0t   192.168.3.11:27018,192.168.6.167:27018,192.168.7.228:27018         44d

```







